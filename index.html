<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Huai Khwang Property Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-900">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import ReactDOM from 'react-dom/client';
        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏û‡∏¥‡πà‡∏° Activity ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô import ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡∏à‡∏∞ Error
        import { Home, DollarSign, TrendingUp, TrendingDown, Zap, Heart, Briefcase, Calendar, AlertTriangle, Award, BarChart3, Users, Building2, Landmark, Activity } from 'lucide-react';

        // ===== COMPLETE GAME DATA =====
        const ARCHETYPES = {
        fresh_grad: {
            name: "Fresh Graduate", nameTH: "‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÄ‡∏Å‡∏¥‡∏ô‡∏£‡πâ‡∏≠‡∏¢", emoji: "üéì",
            desc: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå ‡πÅ‡∏ï‡πà‡πÄ‡∏ï‡πá‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á",
            startSalary: 12000, salaryGrowth: 0.08, savingRate: 0.15, riskAppetite: 4,
            dtiThreshold: 0.50, panicThreshold: 2, mortgagePreference: "floating",
            personality: "‡∏ä‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï ‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏Å‡∏á‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡πÅ‡∏£‡∏Å"
        },
        corporate: {
            name: "Corporate Climber", nameTH: "‡∏ô‡∏±‡∏Å‡∏õ‡∏µ‡∏ô‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£", emoji: "üíº",
            desc: "‡∏°‡∏µ‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏î‡∏µ ‡∏°‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Å‡∏°‡∏´‡∏°‡∏≤‡∏Å‡∏£‡∏∏‡∏Å",
            startSalary: 25000, salaryGrowth: 0.12, savingRate: 0.30, riskAppetite: 3,
            dtiThreshold: 0.35, panicThreshold: 6, mortgagePreference: "fixed",
            personality: "‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏£‡∏∞‡∏ß‡∏±‡∏á ‡∏ä‡∏≠‡∏ö Fixed Rate ‡πÑ‡∏°‡πà‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏Å‡∏á‡πà‡∏≤‡∏¢"
        },
        power_couple: {
            name: "Power Couple", nameTH: "‡∏Ñ‡∏π‡πà‡∏î‡∏±‡∏ö‡πÄ‡∏ö‡∏¥‡πâ‡∏•‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì", emoji: "üë´",
            desc: "‡∏™‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à ‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏û‡∏≠‡∏£‡πå‡∏ï ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î",
            startSalary: 50000, salaryGrowth: 0.07, savingRate: 0.40, riskAppetite: 2,
            dtiThreshold: 0.35, panicThreshold: 999, mortgagePreference: "fixed",
            personality: "‡∏≠‡∏ô‡∏∏‡∏£‡∏±‡∏Å‡∏©‡πå‡∏ô‡∏¥‡∏¢‡∏° ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô ‡∏°‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏°‡∏´‡∏≤‡∏®‡∏≤‡∏•"
        },
        fomo: {
            name: "FOMO Gambler", nameTH: "‡∏ô‡∏±‡∏Å‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÇ‡∏ä‡∏Ñ‡∏ï‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡πÅ‡∏™", emoji: "üé∞",
            desc: "‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡πÅ‡∏™ ‡∏Ç‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ß",
            startSalary: 18000, salaryGrowth: 0.06, savingRate: 0.10, riskAppetite: 5,
            dtiThreshold: 0.50, panicThreshold: 1, mortgagePreference: "floating",
            personality: "All-in ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏Å‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÄ‡∏Ñ‡∏¢‡∏£‡πà‡∏≥‡∏£‡∏ß‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏•‡πâ‡∏°‡∏•‡∏∞‡∏•‡∏≤‡∏¢"
        },
        inheritance: {
            name: "Inheritance Accelerator", nameTH: "‡∏•‡∏π‡∏Å‡∏£‡∏ß‡∏¢ Gen 2", emoji: "üíé",
            desc: "‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÑ‡∏î‡πâ",
            startSalary: 30000, salaryGrowth: 0.04, savingRate: 0.10, riskAppetite: 5,
            dtiThreshold: 0.50, panicThreshold: 999, mortgagePreference: "hybrid",
            inheritanceYears: [2008, 2018], inheritanceAmount: [2000000, 5000000],
            personality: "‡∏°‡∏µ‡πÅ‡∏ú‡∏ô‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÄ‡∏™‡∏°‡∏≠ ‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Luxury ‡∏£‡∏≠‡∏î‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏Å‡∏§‡∏ï"
        },
        late_bloomer: {
            name: "Late Bloomer", nameTH: "‡∏Ñ‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ä‡πâ‡∏≤‡πÅ‡∏ï‡πà‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á", emoji: "üå±",
            desc: "‡∏£‡∏≠‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πà ‡πÑ‡∏°‡πà‡∏£‡∏µ‡∏ö‡∏£‡πâ‡∏≠‡∏ô",
            startSalary: 15000, salaryGrowth: 0.03, savingRate: 0.35, riskAppetite: 2,
            dtiThreshold: 0.35, panicThreshold: 4, mortgagePreference: "fixed",
            startBuyingYear: 2012,
            personality: "‡∏≠‡∏î‡∏ó‡∏ô‡∏£‡∏≠‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î ‡∏û‡∏•‡∏≤‡∏î‡∏ö‡∏π‡∏°‡πÅ‡∏ï‡πà‡∏£‡∏≠‡∏î‡∏ß‡∏¥‡∏Å‡∏§‡∏ï"
        },
        side_hustle: {
            name: "Side-Hustle Entrepreneur", nameTH: "‡∏ô‡∏±‡∏Å‡∏£‡∏ö‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå", emoji: "üöÄ",
            desc: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏ß",
            startSalary: 18000, salaryGrowth: 0.10, savingRate: 0.25, riskAppetite: 4,
            dtiThreshold: 0.45, panicThreshold: 3, mortgagePreference: "floating",
            volatileIncome: true,
            personality: "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡πÜ‡∏•‡∏á‡πÜ ‡∏ã‡∏∑‡πâ‡∏≠‡∏´‡∏•‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≤‡∏ì‡∏≤‡∏à‡∏±‡∏Å‡∏£‡πÄ‡∏ä‡πà‡∏≤"
        },
        expat_chaser: {
            name: "Expat Chaser", nameTH: "‡∏ô‡∏±‡∏Å‡∏•‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏£‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®", emoji: "üåè",
            desc: "‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏ô‡∏Å‡∏±‡∏ö‡∏Å‡∏£‡∏∞‡πÅ‡∏™‡∏ä‡∏≤‡∏ß‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥",
            startSalary: 20000, salaryGrowth: 0.06, savingRate: 0.20, riskAppetite: 5,
            dtiThreshold: 0.50, panicThreshold: 2, mortgagePreference: "floating",
            personality: "‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ä‡∏≤‡∏ß‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥‡∏ä‡∏≠‡∏ö ‡∏ß‡∏¥‡∏Å‡∏§‡∏ï COVID ‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å"
        }
        };

        const TIMELINE = [
        { year: 2000, event: "Baseline", eventTH: "‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", severity: 0, priceChange: { 1: 0, 2: 0, 3: 0 }, rate: 0.035, rental: 0, vacancy: 0.08, sentiment: 50 },
        { year: 2001, event: "Dot-com Hangover", eventTH: "‡∏ü‡∏≠‡∏á‡∏™‡∏ö‡∏π‡πà‡πÑ‡∏≠‡∏ó‡∏µ‡πÅ‡∏ï‡∏Å", severity: 2, priceChange: { 1: -0.03, 2: -0.03, 3: -0.03 }, rate: 0.035, rental: -0.05, vacancy: 0.10, sentiment: 40 },
        { year: 2002, event: "Slow Recovery", eventTH: "‡∏ü‡∏∑‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡∏ä‡πâ‡∏≤‡πÜ", severity: 1, priceChange: { 1: 0.01, 2: 0.01, 3: 0.01 }, rate: 0.032, rental: 0, vacancy: 0.09, sentiment: 45 },
        { year: 2003, event: "SARS Shock", eventTH: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï SARS", severity: 3, priceChange: { 1: -0.05, 2: -0.05, 3: -0.12 }, rate: 0.032, rental: -0.10, vacancy: 0.15, sentiment: 30, unemployment: 0.06 },
        { year: 2004, event: "MRT Launch", eventTH: "‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", severity: 4, priceChange: { 1: 0.08, 2: 0.12, 3: 0.18 }, rate: 0.028, rental: 0.15, vacancy: 0.06, sentiment: 70, boom: true },
        { year: 2005, event: "Golden Age", eventTH: "‡∏¢‡∏∏‡∏Ñ‡∏ó‡∏≠‡∏á ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", severity: 5, priceChange: { 1: 0.12, 2: 0.15, 3: 0.20 }, rate: 0.025, rental: 0.10, vacancy: 0.05, sentiment: 85, boom: true },
        { year: 2006, event: "Boom Continues", eventTH: "‡∏ö‡∏π‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á", severity: 5, priceChange: { 1: 0.12, 2: 0.15, 3: 0.20 }, rate: 0.025, rental: 0.10, vacancy: 0.04, sentiment: 90, boom: true },
        { year: 2007, event: "Peak Euphoria", eventTH: "‡∏à‡∏∏‡∏î‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡∏´‡∏•‡∏á‡πÉ‡∏´‡∏•", severity: 5, priceChange: { 1: 0.12, 2: 0.15, 3: 0.20 }, rate: 0.025, rental: 0.10, vacancy: 0.04, sentiment: 95, boom: true },
        { year: 2008, event: "Lehman Crash", eventTH: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï Lehman Brothers", severity: 5, priceChange: { 1: -0.18, 2: -0.12, 3: -0.25 }, rate: 0.045, rental: -0.20, vacancy: 0.18, sentiment: 15, unemployment: 0.10, crash: true },
        { year: 2009, event: "Stimulus Recovery", eventTH: "‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à", severity: 3, priceChange: { 1: 0.05, 2: 0.08, 3: -0.05 }, rate: 0.030, rental: 0.05, vacancy: 0.12, sentiment: 40 },
        { year: 2010, event: "Rebuild Phase", eventTH: "‡∏£‡∏∞‡∏¢‡∏∞‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π", severity: 2, priceChange: { 1: 0.07, 2: 0.09, 3: 0.10 }, rate: 0.030, rental: 0.06, vacancy: 0.09, sentiment: 55 },
        { year: 2011, event: "Steady Growth", eventTH: "‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á", severity: 2, priceChange: { 1: 0.07, 2: 0.09, 3: 0.10 }, rate: 0.032, rental: 0.06, vacancy: 0.08, sentiment: 60 },
        { year: 2012, event: "Steady Growth", eventTH: "‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á", severity: 2, priceChange: { 1: 0.07, 2: 0.09, 3: 0.10 }, rate: 0.030, rental: 0.06, vacancy: 0.07, sentiment: 60 },
        { year: 2013, event: "Political Noise", eventTH: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡∏≠‡∏á", severity: 2, priceChange: { 1: 0.07, 2: 0.09, 3: 0.10 }, rate: 0.033, rental: 0.06, vacancy: 0.07, sentiment: 55 },
        { year: 2014, event: "Coup Shock", eventTH: "‡∏£‡∏±‡∏ê‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£", severity: 3, priceChange: { 1: -0.05, 2: -0.05, 3: -0.05 }, rate: 0.035, rental: 0, vacancy: 0.10, sentiment: 35 },
        { year: 2015, event: "Chinese Boom", eventTH: "‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡∏•‡∏π‡∏Å‡πÉ‡∏´‡∏°‡πà‡∏à‡∏µ‡∏ô", severity: 4, priceChange: { 1: 0.05, 2: 0.08, 3: 0.25 }, rate: 0.032, rental: 0.12, vacancy: 0.05, sentiment: 75, boom: true },
        { year: 2016, event: "Supply Warnings", eventTH: "‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏≠‡∏∏‡∏õ‡∏ó‡∏≤‡∏ô‡∏•‡πâ‡∏ô", severity: 2, priceChange: { 1: 0.02, 2: 0.05, 3: 0.15 }, rate: 0.035, rental: 0.03, vacancy: 0.09, sentiment: 65 },
        { year: 2017, event: "Overhang Begins", eventTH: "‡∏≠‡∏∏‡∏õ‡∏ó‡∏≤‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡πâ‡∏ô", severity: 2, priceChange: { 1: 0.02, 2: 0.05, 3: 0.15 }, rate: 0.035, rental: 0.03, vacancy: 0.09, sentiment: 60 },
        { year: 2018, event: "LTV Crackdown", eventTH: "‡∏ò‡∏õ‡∏ó.‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î LTV", severity: 3, priceChange: { 1: -0.03, 2: 0.01, 3: 0.08 }, rate: 0.038, rental: 0, vacancy: 0.11, sentiment: 45 },
        { year: 2019, event: "Sideways Grind", eventTH: "‡∏£‡∏≤‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö ‡πÑ‡∏£‡πâ‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á", severity: 2, priceChange: { 1: -0.02, 2: 0.01, 3: 0.03 }, rate: 0.038, rental: -0.02, vacancy: 0.12, sentiment: 40 },
        { year: 2020, event: "COVID Crash", eventTH: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï COVID-19", severity: 5, priceChange: { 1: -0.08, 2: -0.05, 3: -0.35 }, rate: 0.025, rental: -0.25, vacancy: 0.25, sentiment: 10, unemployment: 0.15, crash: true },
        { year: 2021, event: "K-Shaped Recovery", eventTH: "‡∏ü‡∏∑‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏•‡πâ‡∏≥", severity: 3, priceChange: { 1: -0.03, 2: 0.02, 3: 0.40 }, rate: 0.025, rental: -0.10, vacancy: 0.18, sentiment: 50 },
        { year: 2022, event: "Rate Shock", eventTH: "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏û‡∏∏‡πà‡∏á", severity: 4, priceChange: { 1: -0.05, 2: -0.02, 3: 0.05 }, rate: 0.045, rental: 0.03, vacancy: 0.15, sentiment: 35 },
        { year: 2023, event: "China Reopening", eventTH: "‡∏à‡∏µ‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®", severity: 2, priceChange: { 1: 0, 2: 0.02, 3: 0.08 }, rate: 0.040, rental: 0.05, vacancy: 0.12, sentiment: 55 },
        { year: 2024, event: "Consolidation", eventTH: "‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà", severity: 1, priceChange: { 1: 0.01, 2: 0.03, 3: 0.05 }, rate: 0.040, rental: 0.02, vacancy: 0.10, sentiment: 50 },
        { year: 2025, event: "Orange Line Opens", eventTH: "‡∏™‡∏≤‡∏¢‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÄ‡∏õ‡∏¥‡∏î", severity: 4, priceChange: { 1: 0.05, 2: 0.10, 3: 0.15 }, rate: 0.038, rental: 0.08, vacancy: 0.08, sentiment: 70, boom: true }
        ];

        const PROPERTY_TYPES = {
        1: { name: "Entry Level", nameTH: "‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢", emoji: "üè¢", basePrice: 40000, sqm: 25, baseRent: 350, color: "blue" },
        2: { name: "Real Demand", nameTH: "‡πÄ‡∏ô‡πâ‡∏ô‡∏™‡∏°‡∏î‡∏∏‡∏•", emoji: "üè†", basePrice: 55000, sqm: 32, baseRent: 450, color: "green" },
        3: { name: "Prime & Prestige", nameTH: "‡πÄ‡∏ô‡πâ‡∏ô‡∏´‡∏£‡∏π‡∏´‡∏£‡∏≤", emoji: "üè∞", basePrice: 80000, sqm: 50, baseRent: 600, color: "purple" }
        };

        const LIFE_EVENTS = [
        { type: "bonus", name: "‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡∏û‡∏¥‡πÄ‡∏®‡∏©", emoji: "üéÅ", probability: 0.10, calcAmount: (s) => s * 2, impact: "positive" },
        { type: "inheritance", name: "‡πÑ‡∏î‡πâ‡∏°‡∏£‡∏î‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°", emoji: "üí∞", probability: 0.02, calcAmount: () => 500000 + Math.random() * 1000000, impact: "positive" },
        { type: "promotion", name: "‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á", emoji: "üöÄ", probability: 0.08, salaryBoost: 1.15, impact: "positive" },
        { type: "job_loss", name: "‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á", emoji: "üò¢", probability: 0.02, duration: 6, impact: "negative" },
        { type: "medical", name: "‡∏Ñ‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•", emoji: "üè•", probability: 0.03, calcAmount: () => 50000 + Math.random() * 200000, impact: "negative" },
        { type: "fraud", name: "‡πÇ‡∏î‡∏ô‡∏´‡∏•‡∏≠‡∏Å‡∏•‡∏á‡∏ó‡∏∏‡∏ô", emoji: "üö®", probability: 0.01, calcAmount: (c) => c * 0.2, impact: "negative" },
        { type: "maintenance", name: "‡∏ã‡πà‡∏≠‡∏°‡∏ô‡∏¥‡∏ï‡∏¥‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô", emoji: "üîß", probability: 0.03, calcAmount: () => 50000 + Math.random() * 100000, impact: "negative" },
        { type: "windfall", name: "‡πÇ‡∏ä‡∏Ñ‡∏•‡∏≤‡∏† ‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•", emoji: "üé∞", probability: 0.01, calcAmount: () => 100000 + Math.random() * 500000, impact: "positive" }
        ];

        function Game() {
        const [gameState, setGameState] = useState(null);
        const [selectedArchetype, setSelectedArchetype] = useState(null);
        const [showBuyModal, setShowBuyModal] = useState(false);
        const [showSellModal, setShowSellModal] = useState(false);
        const [showStressTest, setShowStressTest] = useState(false);
        const [showAnalytics, setShowAnalytics] = useState(false);
        const [showLifeEvent, setShowLifeEvent] = useState(null);
        const [logs, setLogs] = useState([]);
        const [autoPlay, setAutoPlay] = useState(false);

        useEffect(() => {
            if (autoPlay && gameState && gameState.yearIndex < TIMELINE.length - 1) {
            const timer = setTimeout(() => nextYear(), 1500);
            return () => clearTimeout(timer);
            }
        }, [autoPlay, gameState]);

        const addLog = (msg, type = "info") => {
            setLogs(prev => [...prev, { msg, type, timestamp: Date.now() }]);
        };

        const initGame = (archetypeKey) => {
            const arch = ARCHETYPES[archetypeKey];
            const startCash = arch.startSalary * 12 * arch.savingRate * 2;
            setGameState({
            year: 2000,
            yearIndex: 0,
            archetype: archetypeKey,
            salary: arch.startSalary,
            cash: startCash,
            properties: [],
            totalDebt: 0,
            netWorth: startCash,
            panicCounter: 0,
            unemploymentMonths: 0,
            totalRentalIncome: 0,
            totalInterestPaid: 0,
            lifeEvents: [],
            achievements: [],
            forcedSales: 0,
            panicSales: 0
            });
            setLogs([]);
            addLog(`${arch.emoji} ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°: ${arch.nameTH}`, "success");
            addLog(`üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ${(startCash/1000).toFixed(0)}K ‡∏ö‡∏≤‡∏ó`, "info");
        };

        const buyProperty = (type) => {
            const arch = ARCHETYPES[gameState.archetype];
            const market = TIMELINE[gameState.yearIndex];
            const propData = PROPERTY_TYPES[type];
            
            if (arch.startBuyingYear && gameState.year < arch.startBuyingYear) {
            addLog(`‚è∏Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (‡∏£‡∏≠‡∏ñ‡∏∂‡∏á‡∏õ‡∏µ ${arch.startBuyingYear})`, "warning");
            return;
            }

            const price = propData.basePrice * propData.sqm;
            const downPayment = price * 0.20;
            const loanAmount = price * 0.80;
            
            const mortgageType = arch.mortgagePreference;
            let mortgageRate = market.rate;
            if (mortgageType === "fixed") mortgageRate += 0.005;
            if (mortgageType === "hybrid") mortgageRate += 0.002;
            
            const monthlyPayment = (loanAmount * mortgageRate) / 12 + (loanAmount / (30 * 12));
            const dti = (monthlyPayment * 12) / (gameState.salary * 12);

            if (gameState.cash < downPayment) {
            addLog(`‚ùå ‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠! ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ${(downPayment/1000).toFixed(0)}K`, "error");
            return;
            }

            if (dti > arch.dtiThreshold) {
            addLog(`‚ùå DTI ‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ! ${(dti*100).toFixed(1)}% (‡∏à‡∏≥‡∏Å‡∏±‡∏î ${(arch.dtiThreshold*100).toFixed(0)}%)`, "error");
            return;
            }

            const existingCount = gameState.properties.length;
            let maxLTV = 0.90;
            if (gameState.year >= 2018) {
            if (existingCount === 1) maxLTV = 0.70;
            if (existingCount >= 2) maxLTV = 0.50;
            }

            if (0.80 > maxLTV) {
            addLog(`‚ùå LTV ‡πÄ‡∏Å‡∏¥‡∏ô! (Max ${(maxLTV*100).toFixed(0)}% ‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏µ‡πà ${existingCount + 1})`, "error");
            return;
            }

            const newProperty = {
            id: Date.now(),
            type,
            purchaseYear: gameState.year,
            purchasePrice: price,
            currentValue: price,
            debt: loanAmount,
            monthlyPayment,
            mortgageType,
            rate: mortgageRate,
            rentPerMonth: propData.baseRent * propData.sqm * 0.9,
            isRented: Math.random() > market.vacancy,
            age: 0,
            maintenancePaid: 0
            };

            setGameState(prev => ({
            ...prev,
            cash: prev.cash - downPayment,
            properties: [...prev.properties, newProperty],
            totalDebt: prev.totalDebt + loanAmount
            }));

            addLog(`‚úÖ ‡∏ã‡∏∑‡πâ‡∏≠ Type ${type} ${propData.emoji} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${(price/1000).toFixed(0)}K (${mortgageType})`, "success");
            setShowBuyModal(false);
        };

        const sellProperty = (propId) => {
            const prop = gameState.properties.find(p => p.id === propId);
            if (!prop) return;

            const salePrice = prop.currentValue * 0.98;
            const proceeds = salePrice - prop.debt;
            const capitalGain = salePrice - prop.purchasePrice;
            const holdYears = gameState.year - prop.purchaseYear;
            
            let tax = 0;
            if (holdYears < 5 && capitalGain > 0) {
            tax = capitalGain * 0.15;
            }

            const netProceeds = proceeds - tax;

            setGameState(prev => ({
            ...prev,
            cash: prev.cash + netProceeds,
            properties: prev.properties.filter(p => p.id !== propId),
            totalDebt: prev.totalDebt - prop.debt
            }));

            const profitPercent = ((salePrice - prop.purchasePrice) / prop.purchasePrice * 100).toFixed(1);
            addLog(`üí∞ ‡∏Ç‡∏≤‡∏¢ Type ${prop.type} ‡∏Å‡∏≥‡πÑ‡∏£ ${profitPercent}% | ‡∏£‡∏±‡∏ö ${(netProceeds/1000).toFixed(0)}K`, 
                capitalGain > 0 ? "success" : "warning");
            setShowSellModal(false);
        };

        const runStressTest = () => {
            const market = TIMELINE[gameState.yearIndex];
            const stressRate = market.rate + 0.02;
            const newMonthlyPayments = gameState.properties.reduce((sum, p) => {
            if (p.mortgageType === "floating") {
                return sum + (p.debt * stressRate / 12) + (p.debt / (30 * 12));
            }
            return sum + p.monthlyPayment;
            }, 0);
            
            const stressedDSR = (newMonthlyPayments * 12) / (gameState.salary * 12);
            const stressedIncome = gameState.salary * 0.80;
            const dsr2 = (newMonthlyPayments * 12) / (stressedIncome * 12);
            
            const totalValue = gameState.properties.reduce((sum, p) => sum + p.currentValue, 0);
            const stressedPropertyValue = totalValue * 0.70;
            const stressedEquity = stressedPropertyValue - gameState.totalDebt;
            const stressedLTV = totalValue > 0 ? gameState.totalDebt / stressedPropertyValue : 0;

            return {
            scenario1_dsr: stressedDSR,
            scenario2_dsr: dsr2,
            scenario3_ltv: stressedLTV,
            scenario3_equity: stressedEquity,
            canSurvive: gameState.cash > (gameState.salary * 6) && stressedDSR < 0.60
            };
        };

        const nextYear = () => {
            if (gameState.yearIndex >= TIMELINE.length - 1) {
            addLog(`üèÅ ‡∏à‡∏ö‡πÄ‡∏Å‡∏°! ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${(gameState.netWorth/1000000).toFixed(2)}M ‡∏ö‡∏≤‡∏ó`, "success");
            calculateFinalScore();
            setAutoPlay(false);
            return;
            }

            const arch = ARCHETYPES[gameState.archetype];
            const nextMarket = TIMELINE[gameState.yearIndex + 1];
            
            // Inheritance
            let inheritanceCash = 0;
            if (arch.inheritanceYears && arch.inheritanceYears.includes(nextMarket.year)) {
            const idx = arch.inheritanceYears.indexOf(nextMarket.year);
            inheritanceCash = arch.inheritanceAmount[idx];
            addLog(`üíé ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏£‡∏î‡∏Å ${(inheritanceCash/1000000).toFixed(1)}M ‡∏ö‡∏≤‡∏ó!`, "success");
            }

            // Salary update
            let newSalary = gameState.salary;
            if (gameState.unemploymentMonths > 0) {
            const remaining = gameState.unemploymentMonths - 12;
            if (remaining <= 0) {
                newSalary = gameState.salary * 0.90;
                addLog(`üíº ‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà! ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${(newSalary/1000).toFixed(0)}K`, "success");
            }
            setGameState(prev => ({ ...prev, unemploymentMonths: Math.max(0, remaining) }));
            } else {
            newSalary = gameState.salary * (1 + arch.salaryGrowth);
            if (arch.volatileIncome) {
                const volatility = (Math.random() - 0.5) * 0.6;
                newSalary *= (1 + volatility);
            }
            if (nextMarket.unemployment && nextMarket.unemployment > 0.08) {
                newSalary *= 0.97;
            }
            }

            // Life events
            let lifeEventCash = inheritanceCash;
            let newLifeEvents = [];
            LIFE_EVENTS.forEach(event => {
            let adjustedProb = event.probability;
            
            if (event.type === "job_loss" && nextMarket.unemployment) {
                adjustedProb = event.probability * (nextMarket.unemployment / 0.05);
            }
            
            if (nextMarket.boom && event.type === "bonus") {
                adjustedProb *= 2;
            }
            
            if (Math.random() < adjustedProb) {
                if (event.type === "bonus") {
                const bonus = event.calcAmount(gameState.salary);
                lifeEventCash += bonus;
                newLifeEvents.push({ ...event, amount: bonus });
                addLog(`${event.emoji} ${event.name} +${(bonus/1000).toFixed(0)}K`, "success");
                } else if (event.type === "medical") {
                const cost = event.calcAmount();
                lifeEventCash -= cost;
                newLifeEvents.push({ ...event, amount: cost });
                addLog(`${event.emoji} ${event.name} -${(cost/1000).toFixed(0)}K`, "warning");
                } else if (event.type === "promotion") {
                newSalary *= event.salaryBoost;
                newLifeEvents.push({ ...event });
                addLog(`${event.emoji} ${event.name} +${((event.salaryBoost - 1) * 100).toFixed(0)}%`, "success");
                } else if (event.type === "job_loss" && gameState.unemploymentMonths === 0) {
                setGameState(prev => ({ ...prev, unemploymentMonths: event.duration }));
                newLifeEvents.push({ ...event });
                addLog(`${event.emoji} ${event.name} (${event.duration} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)`, "error");
                } else if (event.type === "windfall") {
                const amount = event.calcAmount();
                lifeEventCash += amount;
                newLifeEvents.push({ ...event, amount });
                addLog(`${event.emoji} ${event.name} +${(amount/1000).toFixed(0)}K`, "success");
                }
            }
            });

            const annualIncome = gameState.unemploymentMonths > 0 ? 0 : newSalary * 12;
            const annualSavings = annualIncome * arch.savingRate;

            let newProperties = gameState.properties.map(prop => {
            const priceMultiplier = 1 + nextMarket.priceChange[prop.type];
            let newValue = prop.currentValue * priceMultiplier;
            
            const age = nextMarket.year - prop.purchaseYear;
            let ageMultiplier = 1.0;
            if (age >= 5 && age < 10) ageMultiplier = 0.98;
            else if (age >= 10 && age < 15) ageMultiplier = 0.95;
            else if (age >= 15) ageMultiplier = 0.92;
            
            newValue *= ageMultiplier;
            
            const rentMultiplier = 1 + nextMarket.rental;
            const newRent = prop.rentPerMonth * rentMultiplier;
            
            const isRented = prop.isRented ? (Math.random() > 0.05) : (Math.random() > nextMarket.vacancy);
            const annualRent = isRented ? newRent * 12 : 0;
            
            let newMortgagePayment = prop.monthlyPayment;
            if (prop.mortgageType === "floating") {
                newMortgagePayment = (prop.debt * nextMarket.rate / 12) + (prop.debt / (30 * 12));
            }

            return {
                ...prop,
                currentValue: newValue,
                rentPerMonth: newRent,
                annualRent,
                isRented,
                monthlyPayment: newMortgagePayment,
                age
            };
            });

            const totalRent = newProperties.reduce((sum, p) => sum + (p.annualRent || 0), 0);
            const totalMortgage = newProperties.reduce((sum, p) => sum + p.monthlyPayment * 12, 0);
            const totalMaintenance = newProperties.reduce((sum, p) => sum + (p.currentValue * 0.005), 0);
            const totalInterest = newProperties.reduce((sum, p) => sum + (p.debt * p.rate), 0);
            
            const netCashFlow = annualSavings + totalRent - totalMortgage - totalMaintenance + lifeEventCash;

            let newCash = gameState.cash + netCashFlow;
            let forcedSaleCount = 0;
            
            while (newCash < 0 && newProperties.length > 0) {
            newProperties.sort((a, b) => (b.currentValue - b.purchasePrice) - (a.currentValue - a.purchasePrice));
            const soldProp = newProperties[newProperties.length - 1];
            const salePrice = soldProp.currentValue * 0.85;
            const proceeds = salePrice - soldProp.debt;
            newProperties = newProperties.slice(0, -1);
            newCash += proceeds;
            forcedSaleCount++;
            addLog(`üö® ‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô! Type ${soldProp.type} ‡πÑ‡∏î‡πâ‡πÄ‡∏á‡∏¥‡∏ô ${(proceeds/1000).toFixed(0)}K`, "error");
            }

            let newPanicCounter = gameState.panicCounter;
            let panicSaleCount = 0;
            if (nextMarket.severity === 5 && nextMarket.priceChange[1] < 0) {
            newPanicCounter++;
            if (newPanicCounter >= arch.panicThreshold && newProperties.length > 0) {
                const soldProp = newProperties[newProperties.length - 1];
                const salePrice = soldProp.currentValue * 0.90;
                const proceeds = salePrice - soldProp.debt;
                newProperties = newProperties.slice(0, -1);
                newCash += proceeds;
                panicSaleCount++;
                addLog(`üò± ‡∏Ç‡∏≤‡∏¢‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏£‡∏∞‡∏´‡∏ô‡∏Å! Type ${soldProp.type}`, "warning");
            }
            } else {
            newPanicCounter = 0;
            }

            const totalValue = newProperties.reduce((sum, p) => sum + p.currentValue, 0);
            const totalDebt = newProperties.reduce((sum, p) => sum + p.debt, 0);
            const newNetWorth = newCash + totalValue - totalDebt;

            const newAchievements = [...gameState.achievements];
            if (newProperties.length >= 3 && !newAchievements.includes("empire")) {
            newAchievements.push("empire");
            addLog(`üèÜ Achievement: Rental Empire`, "success");
            }
            if (newNetWorth > 10000000 && !newAchievements.includes("10m")) {
            newAchievements.push("10m");
            addLog(`üèÜ Achievement: ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ 10M+`, "success");
            }
            if (forcedSaleCount === 0 && nextMarket.year === 2009 && gameState.properties.length > 0 && !newAchievements.includes("survivor_2008")) {
            newAchievements.push("survivor_2008");
            addLog(`üèÜ Achievement: ‡∏£‡∏≠‡∏î‡∏ß‡∏¥‡∏Å‡∏§‡∏ï 2008`, "success");
            }

            setGameState(prev => ({
            ...prev,
            year: nextMarket.year,
            yearIndex: prev.yearIndex + 1,
            salary: newSalary,
            cash: newCash,
            properties: newProperties,
            totalDebt,
            netWorth: newNetWorth,
            panicCounter: newPanicCounter,
            totalRentalIncome: prev.totalRentalIncome + totalRent,
            totalInterestPaid: prev.totalInterestPaid + totalInterest,
            lifeEvents: newLifeEvents,
            achievements: newAchievements,
            forcedSales: prev.forcedSales + forcedSaleCount,
            panicSales: prev.panicSales + panicSaleCount
            }));

            if (newLifeEvents.length > 0) {
            setShowLifeEvent(newLifeEvents[0]);
            setTimeout(() => setShowLifeEvent(null), 3000);
            }

            addLog(`üìÖ ${nextMarket.year}: ${nextMarket.eventTH}`, "info");
        };

        const calculateFinalScore = () => {
            const arch = ARCHETYPES[gameState.archetype];
            const startCapital = arch.startSalary * 12 * arch.savingRate * 2;
            const roi = ((gameState.netWorth - startCapital) / startCapital) * 100;
            
            let grade = "F";
            if (gameState.netWorth > 50000000) grade = "S";
            else if (gameState.netWorth > 25000000) grade = "A+";
            else if (gameState.netWorth > 15000000) grade = "A";
            else if (gameState.netWorth > 10000000) grade = "B";
            else if (gameState.netWorth > 5000000) grade = "C";
            else if (gameState.netWorth > 2000000) grade = "D";
            
            addLog(`üìä Final Grade: ${grade} | ROI: ${roi.toFixed(0)}%`, "success");
        };

        if (!selectedArchetype) {
            return (
            <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 text-white p-4">
                <div className="max-w-6xl mx-auto py-8">
                <div className="text-center mb-12">
                    <h1 className="text-5xl font-bold mb-4">üè¢ Huai Khwang Property Game</h1>
                    <p className="text-2xl text-purple-200 mb-2">The Sims meets Real Estate Investment</p>
                    <p className="text-lg text-purple-300">2000-2025 | 26 ‡∏õ‡∏µ‡πÅ‡∏´‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢</p>
                </div>
                
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    {Object.entries(ARCHETYPES).map(([key, arch]) => (
                    <div
                        key={key}
                        onClick={() => {
                        setSelectedArchetype(key);
                        initGame(key);
                        }}
                        className="bg-white/10 backdrop-blur-lg p-6 rounded-xl cursor-pointer hover:bg-white/20 hover:scale-105 transition-all border-2 border-white/20 hover:border-white/40"
                    >
                        <div className="text-6xl mb-4 text-center">{arch.emoji}</div>
                        <h3 className="text-xl font-bold mb-2 text-center">{arch.nameTH}</h3>
                        <p className="text-sm text-gray-300 mb-4 text-center italic">{arch.desc}</p>
                        <div className="text-sm space-y-2 bg-black/20 p-3 rounded">
                        <div className="flex justify-between">
                            <span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</span>
                            <span className="font-bold">{arch.startSalary.toLocaleString()}</span>
                        </div>
                        <div className="flex justify-between">
                            <span>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á:</span>
                            <span className="font-bold">{"‚≠ê".repeat(arch.riskAppetite)}</span>
                        </div>
                        <div className="flex justify-between">
                            <span>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏≠‡∏≠‡∏°:</span>
                            <span className="font-bold">{(arch.savingRate*100).toFixed(0)}%</span>
                        </div>
                        </div>
                        <div className="mt-4 text-xs text-gray-400 text-center">{arch.personality}</div>
                    </div>
                    ))}
                </div>
                </div>
            </div>
            );
        }

        if (!gameState) return null;

        const arch = ARCHETYPES[gameState.archetype];
        const market = TIMELINE[gameState.yearIndex];
        const totalValue = gameState.properties.reduce((sum, p) => sum + p.currentValue, 0);
        const currentDSR = gameState.properties.length > 0 
            ? (gameState.properties.reduce((sum, p) => sum + p.monthlyPayment * 12, 0) / (gameState.salary * 12))
            : 0;
        const currentLTV = totalValue > 0 ? (gameState.totalDebt / totalValue) : 0;

        const sentimentColor = market.sentiment > 70 ? "green" : market.sentiment > 40 ? "yellow" : "red";
        const sentimentEmoji = market.sentiment > 70 ? "üòÑ" : market.sentiment > 40 ? "üòê" : "üò∞";

        return (
            <div className="min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white p-4">
            <div className="max-w-7xl mx-auto">
                
                {/* Top Bar - Sims Style */}
                <div className="bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-4 mb-4 shadow-2xl border-2 border-white/20">
                <div className="flex justify-between items-center flex-wrap gap-4">
                    <div className="flex items-center gap-4">
                    <div className="text-6xl">{arch.emoji}</div>
                    <div>
                        <h2 className="text-3xl font-bold">{arch.nameTH}</h2>
                        <p className="text-blue-200 text-lg">‡∏õ‡∏µ {gameState.year} | {market.eventTH}</p>
                        <div className="flex gap-2 items-center mt-1">
                        <span className="text-2xl">{sentimentEmoji}</span>
                        <span className="text-sm">‡∏ï‡∏•‡∏≤‡∏î: {market.sentiment}/100</span>
                        </div>
                    </div>
                    </div>
                    <div className="text-right">
                    <p className="text-5xl font-bold bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                        {(gameState.netWorth/1000000).toFixed(2)}M
                    </p>
                    <p className="text-lg text-purple-200">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</p>
                    </div>
                </div>
                </div>

                {/* Stats Grid */}
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4">
                <div className="bg-gradient-to-br from-green-600 to-green-800 p-4 rounded-xl shadow-lg">
                    <DollarSign className="mb-2" size={24} />
                    <p className="text-3xl font-bold">{(gameState.cash/1000).toFixed(0)}K</p>
                    <p className="text-sm opacity-80">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</p>
                </div>
                <div className="bg-gradient-to-br from-blue-600 to-blue-800 p-4 rounded-xl shadow-lg">
                    <Home className="mb-2" size={24} />
                    <p className="text-3xl font-bold">{gameState.properties.length}</p>
                    <p className="text-sm opacity-80">‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î</p>
                </div>
                <div className="bg-gradient-to-br from-purple-600 to-purple-800 p-4 rounded-xl shadow-lg">
                    <Briefcase className="mb-2" size={24} />
                    <p className="text-3xl font-bold">{(gameState.salary/1000).toFixed(0)}K</p>
                    <p className="text-sm opacity-80">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
                </div>
                <div className="bg-gradient-to-br from-red-600 to-red-800 p-4 rounded-xl shadow-lg">
                    <AlertTriangle className="mb-2" size={24} />
                    <p className="text-3xl font-bold">{(gameState.totalDebt/1000000).toFixed(2)}M</p>
                    <p className="text-sm opacity-80">‡∏´‡∏ô‡∏µ‡πâ</p>
                </div>
                </div>

                {/* Risk Meters */}
                <div className="bg-white/10 backdrop-blur-lg rounded-xl p-4 mb-4">
                <h3 className="text-lg font-bold mb-3 flex items-center gap-2">
                    <Activity size={20} /> Health Meters
                </h3>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                    <div className="flex justify-between text-sm mb-1">
                        <span>DSR</span>
                        <span className={currentDSR > 0.50 ? 'text-red-400 font-bold' : 'text-green-400'}>
                        {(currentDSR * 100).toFixed(1)}%
                        </span>
                    </div>
                    <div className="h-2 bg-black/30 rounded-full overflow-hidden">
                        <div 
                        className={`h-full ${currentDSR > 0.50 ? 'bg-red-500' : 'bg-green-500'}`}
                        style={{ width: `${Math.min(currentDSR * 100, 100)}%` }}
                        />
                    </div>
                    </div>
                    <div>
                    <div className="flex justify-between text-sm mb-1">
                        <span>LTV</span>
                        <span className={currentLTV > 0.80 ? 'text-red-400 font-bold' : 'text-green-400'}>
                        {(currentLTV * 100).toFixed(1)}%
                        </span>
                    </div>
                    <div className="h-2 bg-black/30 rounded-full overflow-hidden">
                        <div 
                        className={`h-full ${currentLTV > 0.80 ? 'bg-red-500' : 'bg-green-500'}`}
                        style={{ width: `${Math.min(currentLTV * 100, 100)}%` }}
                        />
                    </div>
                    </div>
                    <div>
                    <div className="flex justify-between text-sm mb-1">
                        <span>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</span>
                        <span className="font-bold">{(market.rate * 100).toFixed(2)}%</span>
                    </div>
                    <div className="h-2 bg-black/30 rounded-full overflow-hidden">
                        <div 
                        className="h-full bg-yellow-500"
                        style={{ width: `${(market.rate / 0.05) * 100}%` }}
                        />
                    </div>
                    </div>
                    <div>
                    <div className="flex justify-between text-sm mb-1">
                        <span>Vacancy</span>
                        <span className="font-bold">{(market.vacancy * 100).toFixed(0)}%</span>
                    </div>
                    <div className="h-2 bg-black/30 rounded-full overflow-hidden">
                        <div 
                        className="h-full bg-orange-500"
                        style={{ width: `${market.vacancy * 100}%` }}
                        />
                    </div>
                    </div>
                </div>
                </div>

                {/* Properties Grid */}
                <div className="bg-white/10 backdrop-blur-lg rounded-xl p-4 mb-4">
                <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                    <Building2 size={24} /> ‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                </h3>
                {gameState.properties.length === 0 ? (
                    <div className="text-center py-8 text-gray-400">
                    <Home size={48} className="mx-auto mb-4 opacity-50" />
                    <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏ã‡∏∑‡πâ‡∏≠" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô!</p>
                    </div>
                ) : (
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                    {gameState.properties.map(prop => {
                        const propType = PROPERTY_TYPES[prop.type];
                        const gainPercent = ((prop.currentValue - prop.purchasePrice) / prop.purchasePrice * 100).toFixed(1);
                        const isUnderwater = prop.currentValue < prop.debt;
                        return (
                        <div key={prop.id} className={`bg-gradient-to-br from-${propType.color}-600 to-${propType.color}-800 p-4 rounded-lg relative overflow-hidden`}>
                            <div className="absolute top-2 right-2 text-4xl opacity-20">{propType.emoji}</div>
                            <div className="relative">
                            <p className="font-bold text-lg mb-1">Type {prop.type} {propType.emoji}</p>
                            <p className="text-sm opacity-80 mb-2">{propType.nameTH}</p>
                            <div className="text-xs space-y-1 bg-black/20 p-2 rounded">
                                <div className="flex justify-between">
                                <span>‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏µ:</span>
                                <span>{prop.purchaseYear}</span>
                                </div>
                                <div className="flex justify-between">
                                <span>‡∏≠‡∏≤‡∏¢‡∏∏:</span>
                                <span>{prop.age} ‡∏õ‡∏µ</span>
                                </div>
                                <div className="flex justify-between">
                                <span>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤:</span>
                                <span>{(prop.currentValue/1000).toFixed(0)}K</span>
                                </div>
                                <div className="flex justify-between">
                                <span>‡∏´‡∏ô‡∏µ‡πâ:</span>
                                <span>{(prop.debt/1000).toFixed(0)}K</span>
                                </div>
                            </div>
                            <div className="mt-2 flex justify-between items-center">
                                <span className={`text-lg font-bold ${parseFloat(gainPercent) >= 0 ? 'text-green-300' : 'text-red-300'}`}>
                                {gainPercent >= 0 ? '+' : ''}{gainPercent}%
                                </span>
                                <span className="text-sm">
                                {prop.isRented ? 'üè† ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πà‡∏≤' : 'üîì ‡∏ß‡πà‡∏≤‡∏á'}
                                </span>
                            </div>
                            {isUnderwater && (
                                <div className="mt-2 text-xs bg-red-500/50 px-2 py-1 rounded text-center font-bold">
                                ‚ö†Ô∏è Underwater
                                </div>
                            )}
                            </div>
                        </div>
                        );
                    })}
                    </div>
                )}
                </div>

                {/* Action Buttons */}
                <div className="grid grid-cols-3 md:grid-cols-6 gap-2 mb-4">
                <button
                    onClick={() => setShowBuyModal(true)}
                    className="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 p-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-lg"
                >
                    üèóÔ∏è ‡∏ã‡∏∑‡πâ‡∏≠
                </button>
                <button
                    onClick={() => setShowSellModal(true)}
                    disabled={gameState.properties.length === 0}
                    className="bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 p-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-lg disabled:opacity-30 disabled:cursor-not-allowed"
                >
                    üí∞ ‡∏Ç‡∏≤‡∏¢
                </button>
                <button
                    onClick={() => setShowStressTest(true)}
                    className="bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 p-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-lg"
                >
                    ‚ö° Test
                </button>
                <button
                    onClick={() => setShowAnalytics(true)}
                    className="bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 p-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-lg"
                >
                    üìä Stats
                </button>
                <button
                    onClick={() => setAutoPlay(!autoPlay)}
                    className={`bg-gradient-to-r ${autoPlay ? 'from-red-600 to-red-700' : 'from-pink-600 to-pink-700'} hover:opacity-90 p-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-lg`}
                >
                    {autoPlay ? '‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î' : '‚ñ∂Ô∏è Auto'}
                </button>
                <button
                    onClick={nextYear}
                    disabled={gameState.yearIndex >= TIMELINE.length - 1}
                    className="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 p-4 rounded-xl font-bold transition-all transform hover:scale-105 shadow-lg disabled:opacity-30"
                >
                    ‚è≠Ô∏è ‡∏õ‡∏µ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
                </button>
                </div>

                {/* Event Log */}
                <div className="bg-white/10 backdrop-blur-lg rounded-xl p-4 max-h-48 overflow-y-auto">
                <h3 className="text-lg font-bold mb-2 flex items-center gap-2 sticky top-0 bg-inherit pb-2">
                    <Calendar size={20} /> Event Log
                </h3>
                {logs.slice(-20).reverse().map((log, i) => (
                    <p key={i} className={`text-sm mb-1 ${
                    log.type === 'error' ? 'text-red-300' :
                    log.type === 'warning' ? 'text-yellow-300' :
                    log.type === 'success' ? 'text-green-300' : 'text-gray-300'
                    }`}>
                    {log.msg}
                    </p>
                ))}
                </div>

                {/* Life Event Popup */}
                {showLifeEvent && (
                <div className="fixed top-1/4 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-br from-purple-600 to-pink-600 p-6 rounded-2xl shadow-2xl border-4 border-white/30 z-50 animate-bounce">
                    <div className="text-center">
                    <div className="text-6xl mb-3">{showLifeEvent.emoji}</div>
                    <h3 className="text-2xl font-bold mb-2">{showLifeEvent.name}</h3>
                    {showLifeEvent.amount && (
                        <p className="text-3xl font-bold">
                        {showLifeEvent.impact === 'positive' ? '+' : '-'}
                        {(Math.abs(showLifeEvent.amount)/1000).toFixed(0)}K
                        </p>
                    )}
                    </div>
                </div>
                )}
            </div>
            </div>
        );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Game />);
    </script>
</body>
</html>
