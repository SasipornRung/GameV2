<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Huai Khwang Simulation: Set & Run</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<body class="bg-slate-900 text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- Data Reference (Based on your Document) ---
        // Growth Rates for each asset type per year (Simplified from source)
        const MARKET_DATA = {
            2009: { t1: 0.08, t2: 0.08, t3: 0.10, event: "Golden Age Begins" },
            2010: { t1: 0.07, t2: 0.09, t3: 0.12, event: "Post-Flood Boom" },
            2011: { t1: 0.10, t2: 0.10, t3: 0.15, event: "First Chinese Wave" },
            2012: { t1: 0.06, t2: 0.08, t3: 0.12, event: "First Car Policy" },
            2013: { t1: 0.05, t2: 0.07, t3: 0.10, event: "Political Unrest" },
            2014: { t1: 0.05, t2: 0.06, t3: 0.08, event: "Coup d'etat" },
            2015: { t1: 0.02, t2: 0.05, t3: 0.06, event: "Supply Overload" },
            2016: { t1: 0.00, t2: 0.04, t3: 0.05, event: "Mass Market Stalls" },
            2017: { t1: -0.02, t2: 0.03, t3: 0.05, event: "Household Debt" },
            2018: { t1: -0.04, t2: 0.01, t3: 0.04, event: "LTV Measure" },
            2019: { t1: -0.03, t2: 0.01, t3: 0.02, event: "Trade War" },
            2020: { t1: -0.15, t2: -0.05, t3: -0.02, event: "COVID Crisis" },
            2021: { t1: -0.05, t2: 0.02, t3: 0.20, event: "Luxury Anomaly" }, // High growth for Luxury
            2022: { t1: -0.02, t2: 0.03, t3: 0.08, event: "Reopening" },
            2023: { t1: -0.03, t2: 0.04, t3: 0.06, event: "Interest Hike" },
            2024: { t1: 0.01, t2: 0.03, t3: 0.05, event: "K-Shape Recovery" }
        };

        const ASSETS = {
            t1: { name: "Entry Level (Mass)", price: 1.5, yield: 0.06 },   // 1.5M
            t2: { name: "Real Demand (Mid)", price: 3.0, yield: 0.045 }, // 3.0M
            t3: { name: "Prime Luxury", price: 6.0, yield: 0.035 }       // 6.0M
        };

        function Simulation() {
            // --- 1. User Inputs (Strategy) ---
            const [career, setCareer] = useState('manager'); // starter, manager, exec
            const [lifestyle, setLifestyle] = useState('saver'); // saver, balanced, spender
            const [strategy, setStrategy] = useState('balanced'); // safe, balanced, aggressive
            const [hasRun, setHasRun] = useState(false);
            const [results, setResults] = useState([]);

            // --- 2. Simulation Logic ---
            const runSimulation = () => {
                let currentYear = 2008;
                // Config based on inputs
                let salary = career === 'starter' ? 18000 : career === 'manager' ? 35000 : 60000;
                let expenseRatio = lifestyle === 'saver' ? 0.4 : lifestyle === 'balanced' ? 0.6 : 0.8;
                
                let cash = 100000; // Start cash
                let portfolio = []; // List of assets { type, value, boughtPrice }
                let history = [];

                for (let year = 2009; year <= 2024; year++) {
                    // A. Career Growth (Auto)
                    salary = salary * 1.10; // +10% per year
                    if ((year - 2009) % 5 === 0) salary *= 1.20; // Promotion every 5 years

                    // B. Cash Flow
                    let yearlyIncome = salary * 12;
                    let yearlyExpense = yearlyIncome * expenseRatio;
                    
                    // Rental Income
                    let rentalIncome = 0;
                    portfolio.forEach(asset => {
                        let actualYield = ASSETS[asset.type].yield;
                        // Crisis Logic: Type 1 yields drop in crisis
                        if (year === 2020 || year === 2021) {
                            if (asset.type === 't1') actualYield = 0; 
                            if (asset.type === 't3') actualYield *= 0.8;
                        }
                        rentalIncome += asset.value * actualYield;
                    });

                    cash += (yearlyIncome - yearlyExpense) + rentalIncome;

                    // C. Market Updates (Asset Growth)
                    const market = MARKET_DATA[year];
                    portfolio.forEach(asset => {
                        asset.value *= (1 + market[asset.type]);
                    });

                    // D. Investment Decision (The Bot Logic)
                    // Strategy: Buy whenever cash > Down Payment (20%) + Buffer
                    let targetAsset = null;
                    if (strategy === 'safe') targetAsset = 't2'; // Buy Mid-tier
                    else if (strategy === 'aggressive') targetAsset = 't3'; // Aim for Luxury
                    else targetAsset = (cash > 2000000) ? 't2' : 't1'; // Mixed

                    // Price calculation (Inflation adjusted)
                    // Simplified: Asset prices grow same as market roughly
                    // Need to track "Market Price" of new assets
                    let marketPriceT1 = ASSETS.t1.price * 1000000;
                    let marketPriceT2 = ASSETS.t2.price * 1000000;
                    let marketPriceT3 = ASSETS.t3.price * 1000000;
                    
                    // Re-calculate market prices based on history
                    for(let y=2009; y<=year; y++) {
                        marketPriceT1 *= (1 + MARKET_DATA[y].t1);
                        marketPriceT2 *= (1 + MARKET_DATA[y].t2);
                        marketPriceT3 *= (1 + MARKET_DATA[y].t3);
                    }

                    let buyTarget = null;
                    let buyPrice = 0;

                    if (strategy === 'safe' && cash > marketPriceT2 * 0.3) { buyTarget = 't2'; buyPrice = marketPriceT2; }
                    else if (strategy === 'aggressive' && cash > marketPriceT3 * 0.3) { buyTarget = 't3'; buyPrice = marketPriceT3; }
                    else if (strategy === 'balanced') {
                        if (cash > marketPriceT2 * 0.3) { buyTarget = 't2'; buyPrice = marketPriceT2; }
                        else if (cash > marketPriceT1 * 0.4 && portfolio.length < 2) { buyTarget = 't1'; buyPrice = marketPriceT1; } // Limit junk assets
                    }

                    // Execute Buy (Assume 80% Loan)
                    if (buyTarget) {
                        // Check if DSR is okay (Simplified: Debt payment < 40% salary)
                        let monthlyInstallment = (buyPrice * 0.8 * 0.006); // Rough installment
                        let currentDebt = portfolio.reduce((sum, p) => sum + (p.boughtPrice * 0.8 * 0.006), 0);
                        
                        if ((currentDebt + monthlyInstallment) < salary * 0.5) {
                            let downPayment = buyPrice * 0.2;
                            cash -= downPayment;
                            portfolio.push({
                                type: buyTarget,
                                value: buyPrice,
                                boughtPrice: buyPrice,
                                yearBought: year
                            });
                        }
                    }

                    // Store History
                    let portfolioValue = portfolio.reduce((sum, p) => sum + p.value, 0);
                    let loanBalance = portfolio.reduce((sum, p) => sum + (p.boughtPrice * 0.8), 0); // Simplified: No principal reduction
                    let netWorth = cash + portfolioValue - loanBalance;

                    history.push({
                        year,
                        salary,
                        netWorth,
                        assetsCount: portfolio.length,
                        event: market.event
                    });
                }
                
                setResults(history);
                setHasRun(true);
            };

            // --- 3. Visualization (Simple SVG Chart) ---
            const Chart = ({ data }) => {
                if (!data || data.length === 0) return null;
                const maxVal = Math.max(...data.map(d => d.netWorth));
                const minVal = Math.min(...data.map(d => d.netWorth));
                const height = 200;
                const width = 100; // percentage
                
                const points = data.map((d, i) => {
                    const x = (i / (data.length - 1)) * 100;
                    const y = 100 - ((d.netWorth - minVal) / (maxVal - minVal || 1)) * 100;
                    return `${x},${y}`;
                }).join(" ");

                return (
                    <div className="w-full h-48 bg-slate-800 rounded-lg relative mt-4 p-2 border border-slate-700">
                        <svg className="w-full h-full overflow-visible" viewBox="0 0 100 100" preserveAspectRatio="none">
                            {/* Grid lines */}
                            <line x1="0" y1="25" x2="100" y2="25" stroke="#334155" strokeWidth="0.5" />
                            <line x1="0" y1="50" x2="100" y2="50" stroke="#334155" strokeWidth="0.5" />
                            <line x1="0" y1="75" x2="100" y2="75" stroke="#334155" strokeWidth="0.5" />
                            
                            {/* The Graph Line */}
                            <polyline points={points} fill="none" stroke="#3b82f6" strokeWidth="2" vectorEffect="non-scaling-stroke" />
                        </svg>
                        
                        {/* Labels for Key Events */}
                        {data.map((d, i) => {
                            if (d.year === 2020 || d.year === 2015 || d.year === 2024) {
                                return (
                                    <div key={i} className="absolute text-[10px] text-gray-400" 
                                         style={{ left: `${(i / (data.length - 1)) * 100}%`, bottom: '-20px', transform: 'translateX(-50%)' }}>
                                        {d.year}
                                    </div>
                                )
                            }
                            return null;
                        })}
                    </div>
                );
            };

            return (
                <div className="min-h-screen p-6 max-w-4xl mx-auto">
                    <h1 className="text-3xl font-bold mb-2 text-blue-400">Huai Khwang Auto-Sim üèôÔ∏è</h1>
                    <p className="text-gray-400 mb-6">‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå 16 ‡∏õ‡∏µ (2009-2024)</p>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        {/* Input Section */}
                        <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h3 className="text-lg font-bold mb-4 text-white">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</h3>
                            <div className="space-y-2">
                                {[
                                    {id: 'starter', label: 'General Staff', sub: 'Start 18k'},
                                    {id: 'manager', label: 'Management Track', sub: 'Start 35k'},
                                    {id: 'exec', label: 'Fast Track / Tech', sub: 'Start 60k'}
                                ].map(c => (
                                    <div key={c.id} 
                                        onClick={() => setCareer(c.id)}
                                        className={`p-3 rounded cursor-pointer transition ${career === c.id ? 'bg-blue-600 border border-blue-400' : 'bg-slate-700 hover:bg-slate-600'}`}>
                                        <div className="font-bold">{c.label}</div>
                                        <div className="text-xs opacity-75">{c.sub} (+10%/‡∏õ‡∏µ)</div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h3 className="text-lg font-bold mb-4 text-white">2. ‡∏ô‡∏¥‡∏™‡∏±‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô</h3>
                            <div className="space-y-2">
                                {[
                                    {id: 'saver', label: '‡∏™‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î', sub: '‡πÉ‡∏ä‡πâ 40% ‡πÄ‡∏Å‡πá‡∏ö 60%'},
                                    {id: 'balanced', label: '‡∏™‡∏≤‡∏¢‡∏™‡∏°‡∏î‡∏∏‡∏• (Balance)', sub: '‡πÉ‡∏ä‡πâ 60% ‡πÄ‡∏Å‡πá‡∏ö 40%'},
                                    {id: 'spender', label: '‡∏™‡∏≤‡∏¢‡πÄ‡∏õ‡∏¢‡πå (YOLO)', sub: '‡πÉ‡∏ä‡πâ 80% ‡πÄ‡∏Å‡πá‡∏ö 20%'}
                                ].map(l => (
                                    <div key={l.id} 
                                        onClick={() => setLifestyle(l.id)}
                                        className={`p-3 rounded cursor-pointer transition ${lifestyle === l.id ? 'bg-green-600 border border-green-400' : 'bg-slate-700 hover:bg-slate-600'}`}>
                                        <div className="font-bold">{l.label}</div>
                                        <div className="text-xs opacity-75">{l.sub}</div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                            <h3 className="text-lg font-bold mb-4 text-white">3. ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏•‡∏á‡∏ó‡∏∏‡∏ô</h3>
                            <div className="space-y-2">
                                {[
                                    {id: 'balanced', label: 'Mixed Strategy', sub: '‡∏ã‡∏∑‡πâ‡∏≠‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå'},
                                    {id: 'safe', label: 'Quality Focus', sub: '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠‡∏ã‡∏∑‡πâ‡∏≠ Type 2 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'},
                                    {id: 'aggressive', label: 'Sniper (Luxury)', sub: '‡πÄ‡∏•‡πá‡∏á Type 3 (‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢‡∏≤‡∏Å)'}
                                ].map(s => (
                                    <div key={s.id} 
                                        onClick={() => setStrategy(s.id)}
                                        className={`p-3 rounded cursor-pointer transition ${strategy === s.id ? 'bg-purple-600 border border-purple-400' : 'bg-slate-700 hover:bg-slate-600'}`}>
                                        <div className="font-bold">{s.label}</div>
                                        <div className="text-xs opacity-75">{s.sub}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>

                    <button 
                        onClick={runSimulation}
                        className="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-400 hover:to-purple-500 text-white font-bold text-xl py-4 rounded-xl shadow-lg mb-8 transition transform active:scale-95"
                    >
                        üöÄ Run Simulation (2008-2024)
                    </button>

                    {/* Results Section */}
                    {hasRun && (
                        <div className="bg-slate-800 p-6 rounded-xl border border-slate-700 animate-fade-in">
                            <div className="flex justify-between items-end mb-4">
                                <div>
                                    <h2 className="text-2xl font-bold">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏õ‡∏µ 2024</h2>
                                    <p className="text-gray-400">‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Net Worth)</p>
                                </div>
                                <div className="text-right">
                                    <div className="text-4xl font-bold text-green-400">
                                        {(results[results.length-1].netWorth / 1000000).toFixed(2)}M
                                    </div>
                                    <div className="text-sm text-gray-400">
                                        ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏à‡∏ö‡∏ó‡∏µ‡πà: {(results[results.length-1].salary).toLocaleString()}
                                    </div>
                                </div>
                            </div>

                            <div className="grid grid-cols-3 gap-4 mb-6">
                                <div className="bg-slate-900 p-3 rounded text-center">
                                    <div className="text-xs text-gray-400">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô</div>
                                    <div className="text-xl font-bold">{results[results.length-1].assetsCount} ‡∏¢‡∏π‡∏ô‡∏¥‡∏ï</div>
                                </div>
                                <div className="bg-slate-900 p-3 rounded text-center">
                                    <div className="text-xs text-gray-400">‡∏ú‡πà‡∏≤‡∏ô‡∏ß‡∏¥‡∏Å‡∏§‡∏ï COVID</div>
                                    <div className={`text-xl font-bold ${results.find(r => r.year === 2020).netWorth > 0 ? 'text-green-400' : 'text-red-400'}`}>
                                        {results.find(r => r.year === 2020).netWorth > 0 ? '‡∏£‡∏≠‡∏î ‚úÖ' : '‡∏•‡πâ‡∏°‡∏•‡∏∞‡∏•‡∏≤‡∏¢ ‚ùå'}
                                    </div>
                                </div>
                                <div className="bg-slate-900 p-3 rounded text-center">
                                    <div className="text-xs text-gray-400">Performance</div>
                                    <div className="text-xl font-bold text-blue-400">
                                        {results[results.length-1].netWorth > 10000000 ? 'Wealthy üèÜ' : 'Average üòê'}
                                    </div>
                                </div>
                            </div>

                            <h3 className="font-bold text-gray-300">‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡πà‡∏á</h3>
                            <Chart data={results} />
                            
                            {/* Analysis Text */}
                            <div className="mt-6 p-4 bg-slate-900/50 rounded border-l-4 border-yellow-500 text-sm space-y-2">
                                <p className="font-bold text-yellow-400">üí° ‡∏ö‡∏ó‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏≤‡∏Å AI:</p>
                                {strategy === 'aggressive' && results[results.length-1].netWorth > 15000000 ? (
                                    <p>‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å! ‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏ã‡∏∑‡πâ‡∏≠ Luxury (Type 3) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏Ñ‡∏∏‡∏ì‡πÇ‡∏ï‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î‡πÉ‡∏ô‡∏õ‡∏µ 2021 ‡∏ã‡∏∂‡πà‡∏á‡∏ä‡∏ô‡∏∞‡∏ï‡∏•‡∏≤‡∏î Mass Market ‡∏Ç‡∏≤‡∏î‡∏•‡∏≠‡∏¢</p>
                                ) : strategy === 'balanced' && results[results.length-1].assetsCount > 3 ? (
                                    <p>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÅ‡∏ï‡πà‡∏£‡∏∞‡∏ß‡∏±‡∏á! ‡∏Å‡∏≤‡∏£‡∏°‡∏µ Type 1 ‡πÄ‡∏¢‡∏≠‡∏∞‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏µ 2016 ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÑ‡∏°‡πà‡πÑ‡∏õ‡πÑ‡∏´‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏•‡∏≤‡∏î‡∏ô‡∏¥‡πà‡∏á</p>
                                ) : (
                                    <p>‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Asset Class ‡∏°‡∏µ‡∏ú‡∏•‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏Ñ‡∏ß‡∏¥‡∏î (K-Shaped Recovery) ‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏î‡∏π‡πÑ‡∏´‡∏°?</p>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Simulation />);
    </script>
</body>
</html>
