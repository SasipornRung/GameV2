<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Property Archetype: Bangkok Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f0f4f8; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card-hover:hover { transform: translateY(-5px); transition: all 0.3s; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
</head>
<body class="text-gray-800">

    <div id="app" class="max-w-4xl mx-auto min-h-screen bg-white shadow-2xl relative overflow-hidden">
        
        <header class="bg-slate-900 text-white p-6 flex justify-between items-center shadow-lg z-10 relative">
            <div>
                <h1 class="text-2xl font-bold tracking-wider">üèôÔ∏è THE PROPERTY ARCHETYPE</h1>
                <p class="text-xs text-slate-400">Bangkok Real Estate Simulator</p>
            </div>
            <div id="status-bar" class="hidden text-right">
                <p class="text-sm">Year: <span id="year-display" class="font-bold text-yellow-400">2019</span></p>
                <p class="text-sm">Cash: <span id="cash-display" class="font-bold text-green-400">0</span> THB</p>
            </div>
        </header>

        <section id="scene-character" class="p-10 fade-in h-full flex flex-col justify-center">
            <h2 class="text-3xl font-bold text-center mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            <p class="text-center text-gray-500 mb-8">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <button onclick="selectCharacter('junior')" class="card-hover bg-slate-100 p-6 rounded-xl border-2 border-slate-200 hover:border-blue-500 text-left group">
                    <div class="text-4xl mb-4">üéí</div>
                    <h3 class="text-xl font-bold group-hover:text-blue-600">The First Jobber</h3>
                    <p class="text-sm text-gray-500 mt-2">Salary: 25,000 THB</p>
                    <p class="text-sm text-gray-500">Credit Line: 2.5 MB</p>
                    <p class="text-xs text-blue-500 mt-4 font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢: ‡∏á‡∏ö‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</p>
                </button>
                
                <button onclick="selectCharacter('manager')" class="card-hover bg-slate-100 p-6 rounded-xl border-2 border-slate-200 hover:border-purple-500 text-left group">
                    <div class="text-4xl mb-4">üíº</div>
                    <h3 class="text-xl font-bold group-hover:text-purple-600">The Manager</h3>
                    <p class="text-sm text-gray-500 mt-2">Salary: 70,000 THB</p>
                    <p class="text-sm text-gray-500">Credit Line: 6.0 MB</p>
                    <p class="text-xs text-purple-500 mt-4 font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢: ‡∏Å‡∏±‡∏ö‡∏î‡∏±‡∏Å‡∏ä‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á</p>
                </button>
                
                <button onclick="selectCharacter('exec')" class="card-hover bg-slate-100 p-6 rounded-xl border-2 border-slate-200 hover:border-amber-500 text-left group">
                    <div class="text-4xl mb-4">ü•Ç</div>
                    <h3 class="text-xl font-bold group-hover:text-amber-600">The Executive</h3>
                    <p class="text-sm text-gray-500 mt-2">Salary: 200,000+ THB</p>
                    <p class="text-sm text-gray-500">Credit Line: 15.0 MB</p>
                    <p class="text-xs text-amber-500 mt-4 font-bold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢: ‡∏≠‡∏µ‡πÇ‡∏Å‡πâ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å</p>
                </button>
            </div>
        </section>

        <section id="scene-map" class="hidden p-6 fade-in relative">
            <h2 class="text-2xl font-bold text-center mb-6">Interactive Market Map (Year 2019)</h2>
            <div class="bg-blue-50 p-4 rounded-lg mb-6 border-l-4 border-blue-500 text-sm">
                <p>üí° <b>Market Insight:</b> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥‡πÄ‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 5 ‡∏õ‡∏µ (2014-2019)</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 h-[500px]">
                <div onclick="selectDistrict('A')" class="card-hover cursor-pointer relative bg-white border-2 border-gray-200 rounded-2xl p-6 overflow-hidden hover:border-red-500">
                    <div class="absolute top-0 right-0 bg-red-500 text-white text-xs px-2 py-1 rounded-bl-lg font-bold">HOT üî•</div>
                    <h3 class="text-2xl font-bold text-gray-800">üìç District A (Huai Khwang)</h3>
                    <p class="text-gray-500 text-sm mb-4">New CBD Extension</p>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between border-b pb-1">
                            <span>Avg Price:</span>
                            <span class="font-bold text-green-600">145,000 / sq.m.</span>
                        </div>
                        <div class="flex justify-between border-b pb-1">
                            <span>5-Year Growth:</span>
                            <span class="font-bold text-green-600">+45% üöÄ</span>
                        </div>
                        <div class="flex justify-between border-b pb-1">
                            <span>Avg Yield:</span>
                            <span class="font-bold text-gray-600">4.8%</span>
                        </div>
                    </div>
                    <div class="mt-4 h-32 bg-gray-50 rounded flex items-end px-2 space-x-2">
                        <div class="w-1/5 bg-red-200 h-[40%]"></div>
                        <div class="w-1/5 bg-red-300 h-[55%]"></div>
                        <div class="w-1/5 bg-red-400 h-[70%]"></div>
                        <div class="w-1/5 bg-red-500 h-[85%]"></div>
                        <div class="w-1/5 bg-red-600 h-[100%] shadow-lg relative"><span class="absolute -top-6 left-0 text-xs font-bold text-red-600">Strong Buy</span></div>
                    </div>
                </div>

                <div onclick="selectDistrict('B')" class="card-hover cursor-pointer relative bg-white border-2 border-gray-200 rounded-2xl p-6 overflow-hidden hover:border-blue-500">
                    <h3 class="text-2xl font-bold text-gray-800">üìç District B (Bang Sue)</h3>
                    <p class="text-gray-500 text-sm mb-4">Transportation Hub</p>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between border-b pb-1">
                            <span>Avg Price:</span>
                            <span class="font-bold text-blue-600">95,000 / sq.m.</span>
                        </div>
                        <div class="flex justify-between border-b pb-1">
                            <span>5-Year Growth:</span>
                            <span class="font-bold text-blue-600">+15% üê¢</span>
                        </div>
                        <div class="flex justify-between border-b pb-1">
                            <span>Avg Yield:</span>
                            <span class="font-bold text-gray-600">5.2%</span>
                        </div>
                    </div>
                     <div class="mt-4 h-32 bg-gray-50 rounded flex items-end px-2 space-x-2">
                        <div class="w-1/5 bg-blue-200 h-[40%]"></div>
                        <div class="w-1/5 bg-blue-300 h-[45%]"></div>
                        <div class="w-1/5 bg-blue-300 h-[48%]"></div>
                        <div class="w-1/5 bg-blue-400 h-[50%]"></div>
                        <div class="w-1/5 bg-blue-400 h-[52%]"></div>
                    </div>
                </div>
            </div>
        </section>

        <section id="scene-archetype" class="hidden p-8 fade-in">
            <h2 class="text-2xl font-bold text-center mb-2">‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Asset ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô <span id="district-name" class="text-blue-600"></span></h2>
            <p class="text-center text-gray-500 mb-8 text-sm">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <span id="budget-display" class="font-bold text-green-600"></span> THB</p>

            <div class="grid grid-cols-1 gap-4" id="archetype-container">
                </div>
        </section>

        <section id="scene-sim" class="hidden p-10 fade-in text-center h-full flex flex-col items-center justify-center">
            <div class="mb-8">
                <h2 class="text-4xl font-bold mb-2">Year: <span id="sim-year">2020</span></h2>
                <div id="event-box" class="bg-yellow-100 border-l-4 border-yellow-500 p-4 text-left w-full max-w-lg mx-auto shadow-md">
                    <p class="font-bold text-lg text-yellow-800" id="event-title">Breaking News</p>
                    <p class="text-gray-700" id="event-desc">Event description...</p>
                </div>
            </div>

            <div class="w-full max-w-md bg-gray-200 rounded-full h-2.5 mb-6 dark:bg-gray-700">
                <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
            </div>

            <div id="sim-stats" class="grid grid-cols-2 gap-8 text-left w-full max-w-lg mb-8">
                <div class="bg-white p-4 rounded shadow">
                    <p class="text-xs text-gray-500">Asset Price</p>
                    <p class="text-xl font-bold" id="current-asset-price">-</p>
                </div>
                <div class="bg-white p-4 rounded shadow">
                    <p class="text-xs text-gray-500">Rental Income (Acc)</p>
                    <p class="text-xl font-bold text-green-600" id="current-rent">-</p>
                </div>
            </div>

            <button id="next-year-btn" onclick="nextTurn()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105">
                Start Year 2020
            </button>
        </section>

        <section id="scene-result" class="hidden p-8 fade-in overflow-y-auto max-h-screen">
            <h2 class="text-3xl font-bold text-center text-gray-900 mb-6">‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
            
            <div class="bg-white border-2 border-slate-200 rounded-xl p-6 mb-8 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£ (Net Worth)</h3>
                    <span id="final-score" class="text-2xl font-bold"></span>
                </div>
                <div class="h-64">
                    <canvas id="resultChart"></canvas>
                </div>
            </div>

            <div class="space-y-4">
                <div class="bg-red-50 p-6 rounded-lg border-l-4 border-red-500">
                    <h4 class="font-bold text-red-700 mb-2">‚ö†Ô∏è The Truth About Averages (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢)</h4>
                    <p class="text-sm text-gray-700 mb-2">
                        ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏´‡πá‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡πÑ‡∏´‡∏°? <b id="result-district-name"></b> ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞ <span class="font-bold bg-yellow-200">"Condo Type 3 (Luxury)"</span> ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ï‡∏∂‡∏Å‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
                    </p>
                    <p class="text-sm text-gray-700">
                        ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ó‡∏µ‡πà <span class="font-bold bg-gray-200">"Condo Type 1 (Entry Level)"</span> ‡πÉ‡∏ô‡∏¢‡πà‡∏≤‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏Å‡∏ï‡πà‡∏≥‡∏•‡∏á‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Oversupply ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à (K-Shaped Recovery)
                    </p>
                </div>

                <div class="bg-green-50 p-6 rounded-lg border-l-4 border-green-500">
                    <h4 class="font-bold text-green-700 mb-2">üéØ Archetype Strategy</h4>
                    <p class="text-sm text-gray-700">
                        ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ó‡∏µ‡πà "‡∏â‡∏•‡∏≤‡∏î" ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏û‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠ <b>Archetype ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏¢‡πà‡∏≤‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ</b>:
                    </p>
                    <ul class="list-disc ml-5 mt-2 text-sm text-gray-600 space-y-1">
                        <li><b>‡∏¢‡πà‡∏≤‡∏ô‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á (A):</b> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö <i>Type 3 (Prime)</i> ‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏° Expat/‡∏à‡∏µ‡∏ô ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏∏‡πà‡∏á‡πÅ‡∏£‡∏á [cite: 27, 33]</li>
                        <li><b>‡∏¢‡πà‡∏≤‡∏ô‡∏ö‡∏≤‡∏á‡∏ã‡∏∑‡πà‡∏≠ (B):</b> ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö <i>Type 2 (Real Demand)</i> ‡πÉ‡∏Å‡∏•‡πâ‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á</li>
                        <li><b>‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ:</b> ‡∏ã‡∏∑‡πâ‡∏≠ Type 1 ‡πÉ‡∏ô‡∏¢‡πà‡∏≤‡∏ô A ‡∏´‡∏ß‡∏±‡∏á‡∏Å‡∏≥‡πÑ‡∏£‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‡πÅ‡∏ï‡πà‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÄ‡∏¢‡∏≠‡∏∞‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏≤‡∏¢‡∏ä‡πà‡∏ß‡∏á‡πÇ‡∏Ñ‡∏ß‡∏¥‡∏î [cite: 9, 31]</li>
                    </ul>
                </div>
            </div>

            <button onclick="location.reload()" class="mt-8 w-full bg-slate-800 text-white py-4 rounded-lg font-bold hover:bg-slate-700">‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
        </section>

    </div>

    <script>
        // --- GAME DATA ---
        const gameData = {
            character: null,
            budget: 0,
            selectedDistrict: null,
            selectedArchetype: null,
            currentYear: 2019,
            endYear: 2024,
            history: {
                years: [],
                playerValue: [],
                marketAverage: []
            },
            asset: {
                initialPrice: 0,
                currentPrice: 0,
                accRent: 0
            }
        };

        const archetypesData = {
            'A': [ // Huai Khwang (High Volatility, K-Shape)
                {
                    id: 'A1',
                    name: 'Type 1: Entry Level (Deep Soi)',
                    desc: '‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡πÄ‡∏•‡πá‡∏Å‡πÉ‡∏ô‡∏ã‡∏≠‡∏¢‡∏•‡∏∂‡∏Å ‡πÄ‡∏ô‡πâ‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÄ‡∏ä‡πà‡∏≤‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å',
                    price: 2200000,
                    yield: 0.055,
                    tags: ['High Risk', 'Mass Market'],
                    volatility: 'high', // Crashes hard in crisis
                    baseGrowth: 0.01
                },
                {
                    id: 'A2',
                    name: 'Type 2: Real Demand',
                    desc: '‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡πÄ‡∏î‡∏¥‡∏ô‡∏ñ‡∏∂‡∏á MRT ‡πÑ‡∏î‡πâ',
                    price: 4500000,
                    yield: 0.045,
                    tags: ['Stable', 'White Collar'],
                    volatility: 'medium',
                    baseGrowth: 0.03
                },
                {
                    id: 'A3',
                    name: 'Type 3: Prime & Prestige',
                    desc: 'Luxury ‡∏ï‡∏¥‡∏î‡∏ñ‡∏ô‡∏ô‡πÉ‡∏´‡∏ç‡πà/MRT ‡πÄ‡∏ô‡πâ‡∏ô Expat',
                    price: 12000000,
                    yield: 0.04,
                    tags: ['Capital Gain', 'Scarce'],
                    volatility: 'k-shape', // Moons in recovery
                    baseGrowth: 0.06
                }
            ],
            'B': [ // Bang Sue (Steady, Boring)
                {
                    id: 'B1',
                    name: 'Type 1: Budget Condo',
                    desc: '‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å',
                    price: 1800000,
                    yield: 0.05,
                    tags: ['Low Entry'],
                    volatility: 'medium',
                    baseGrowth: 0.02
                },
                {
                    id: 'B2',
                    name: 'Type 2: Transport Hub',
                    desc: '‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏Å‡∏•‡∏≤‡∏á‡∏Ø ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏™‡∏∞‡∏î‡∏ß‡∏Å',
                    price: 3500000,
                    yield: 0.048,
                    tags: ['Growth Potential'],
                    volatility: 'low', // Very resilient
                    baseGrowth: 0.04
                }
            ]
        };

        const events = {
            2020: { title: "COVID-19 Pandemic ü¶†", desc: "‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡πÇ‡∏£‡∏Ñ‡∏£‡∏∞‡∏ö‡∏≤‡∏î! ‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥‡∏´‡∏≤‡∏¢ ‡∏Ñ‡∏ô‡∏ï‡∏Å‡∏á‡∏≤‡∏ô Demand ‡∏´‡∏î‡∏ï‡∏±‡∏ß‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á", effect: "CRASH" },
            2021: { title: "Supply Glut & LTV üî•", desc: "‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ç‡∏≤‡∏¢‡∏ö‡∏≤‡∏ô‡πÄ‡∏ö‡∏≠‡∏∞ ‡πÅ‡∏ö‡∏á‡∏Ñ‡πå‡∏ä‡∏≤‡∏ï‡∏¥‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏™‡∏¥‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠", effect: "STAGNATE" },
            2022: { title: "Recovery Signs üå§Ô∏è", desc: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® ‡∏à‡∏µ‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤", effect: "RECOVERY" },
            2023: { title: "The K-Shaped Boom üìà", desc: "‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à‡∏ü‡∏∑‡πâ‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡πà‡∏≠‡∏°‡∏•‡πâ‡∏≥ ‡∏Ç‡∏≠‡∏á‡∏´‡∏£‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ ‡∏Ç‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏ã‡∏∂‡∏°‡∏¢‡∏≤‡∏ß", effect: "K-BOOM" },
            2024: { title: "New Normal üèÅ", desc: "‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏¢‡∏∏‡∏Ñ‡πÉ‡∏´‡∏°‡πà", effect: "NORMAL" }
        };

        // --- FUNCTIONS ---

        function show(id) {
            document.querySelectorAll('section').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function updateStatus() {
            document.getElementById('status-bar').classList.remove('hidden');
            document.getElementById('cash-display').innerText = gameData.budget.toLocaleString();
            document.getElementById('year-display').innerText = gameData.currentYear;
        }

        function selectCharacter(role) {
            if(role === 'junior') gameData.budget = 2500000;
            if(role === 'manager') gameData.budget = 6000000;
            if(role === 'exec') gameData.budget = 15000000;
            
            gameData.character = role;
            updateStatus();
            show('scene-map');
        }

        function selectDistrict(d) {
            gameData.selectedDistrict = d;
            const districtName = d === 'A' ? 'Huai Khwang (The Star)' : 'Bang Sue (The Value)';
            document.getElementById('district-name').innerText = districtName;
            
            // Render Archetypes based on Budget
            const container = document.getElementById('archetype-container');
            container.innerHTML = '';
            
            const options = archetypesData[d];
            let hasOption = false;

            options.forEach(opt => {
                const isAffordable = gameData.budget >= opt.price;
                const opacity = isAffordable ? 'opacity-100' : 'opacity-50 cursor-not-allowed';
                const btnState = isAffordable ? `onclick="buyArchetype('${opt.id}')"` : 'disabled';
                const affordText = isAffordable ? '<span class="text-green-600 font-bold">‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ</span>' : '<span class="text-red-500 font-bold">‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠</span>';

                if(isAffordable) hasOption = true;

                const html = `
                <div class="bg-white border rounded-xl p-4 flex justify-between items-center shadow-sm ${opacity} hover:shadow-md transition">
                    <div>
                        <div class="flex items-center gap-2">
                            <h3 class="font-bold text-lg">${opt.name}</h3>
                            ${opt.tags.map(t => `<span class="text-xs bg-gray-200 px-2 py-1 rounded text-gray-600">${t}</span>`).join('')}
                        </div>
                        <p class="text-sm text-gray-500">${opt.desc}</p>
                        <p class="mt-1 font-mono">‡∏£‡∏≤‡∏Ñ‡∏≤: ${opt.price.toLocaleString()} THB | Yield: ${(opt.yield*100).toFixed(1)}%</p>
                    </div>
                    <div class="text-right">
                        ${affordText}
                        <button ${btnState} class="block mt-2 bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 disabled:bg-gray-400">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</button>
                    </div>
                </div>`;
                container.innerHTML += html;
            });

            if(!hasOption) {
                alert("‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏¢‡πà‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÉ‡∏´‡∏°‡πà");
                return;
            }

            show('scene-archetype');
            document.getElementById('budget-display').innerText = gameData.budget.toLocaleString();
        }

        function buyArchetype(id) {
            const districtOpts = archetypesData[gameData.selectedDistrict];
            const selected = districtOpts.find(o => o.id === id);
            
            gameData.selectedArchetype = selected;
            gameData.asset.initialPrice = selected.price;
            gameData.asset.currentPrice = selected.price;
            gameData.asset.accRent = 0;
            
            // Initial Chart Data
            gameData.history.years.push(2019);
            gameData.history.playerValue.push(selected.price);
            
            show('scene-sim');
            updateSimUI();
        }

        function updateSimUI() {
            document.getElementById('sim-year').innerText = gameData.currentYear;
            document.getElementById('current-asset-price').innerText = Math.round(gameData.asset.currentPrice).toLocaleString();
            document.getElementById('current-rent').innerText = Math.round(gameData.asset.accRent).toLocaleString();
            
            if (gameData.currentYear < gameData.endYear) {
                const evt = events[gameData.currentYear + 1]; // Preview next event or current? Let's show current year logic
                // Logic: Click button -> Advance Year -> Show what happened
                document.getElementById('next-year-btn').innerText = `Advance to ${gameData.currentYear + 1}`;
                document.getElementById('event-box').classList.add('hidden'); // Hide until processed
            } else {
                document.getElementById('next-year-btn').innerText = "See Results";
            }
        }

        function nextTurn() {
            if(gameData.currentYear >= gameData.endYear) {
                finishGame();
                return;
            }

            gameData.currentYear++;
            const evt = events[gameData.currentYear];
            
            // --- CORE SIMULATION LOGIC ---
            const arch = gameData.selectedArchetype;
            let priceChange = 0;
            let rentCollection = 0;

            // 1. Base Growth
            priceChange += arch.baseGrowth;

            // 2. Event Impact based on Archetype Volatility
            if (evt.effect === 'CRASH') { // COVID 2020
                if(arch.volatility === 'high') priceChange -= 0.15; // Type 1 drops hard
                else if(arch.volatility === 'k-shape') priceChange -= 0.05; // Luxury dips slightly
                else priceChange -= 0.02; // Stable dips a bit
                rentCollection = 0.5; // Occupancy drops
            } 
            else if (evt.effect === 'STAGNATE') { // 2021
                if(arch.volatility === 'high') priceChange -= 0.05; // Type 1 continues to bleed
                else if(arch.volatility === 'k-shape') priceChange += 0.10; // Luxury starts rebound (Anomaly) [cite: 65]
                else priceChange += 0.01;
                rentCollection = 0.7;
            }
            else if (evt.effect === 'K-BOOM') { // 2023
                if(arch.volatility === 'high') priceChange -= 0.02; // Mass market still suffers debt
                else if(arch.volatility === 'k-shape') priceChange += 0.15; // Luxury skyrockets
                else priceChange += 0.04; // Normal growth
                rentCollection = 0.9;
            }
            else { // Recovery / Normal
                priceChange += 0.02;
                rentCollection = 0.95;
            }

            // Apply changes
            gameData.asset.currentPrice = gameData.asset.currentPrice * (1 + priceChange);
            const yearlyRent = (gameData.asset.initialPrice * arch.yield) * rentCollection;
            gameData.asset.accRent += yearlyRent;

            // Record History
            gameData.history.years.push(gameData.currentYear);
            gameData.history.playerValue.push(gameData.asset.currentPrice);

            // UI Update
            document.getElementById('event-box').classList.remove('hidden');
            document.getElementById('event-title').innerText = evt.title;
            document.getElementById('event-desc').innerText = evt.desc;
            
            const progress = ((gameData.currentYear - 2019) / 5) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            updateSimUI();
        }

        function finishGame() {
            show('scene-result');
            const totalValue = gameData.asset.currentPrice + gameData.asset.accRent;
            const profit = totalValue - gameData.asset.initialPrice;
            const percent = (profit / gameData.asset.initialPrice) * 100;

            const scoreEl = document.getElementById('final-score');
            scoreEl.innerText = `${percent.toFixed(1)}% (${(profit/1000000).toFixed(2)} MB)`;
            scoreEl.className = percent > 0 ? "text-2xl font-bold text-green-600" : "text-2xl font-bold text-red-600";

            document.getElementById('result-district-name').innerText = gameData.selectedDistrict === 'A' ? '‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á' : '‡∏ö‡∏≤‡∏á‡∏ã‡∏∑‡πà‡∏≠';

            renderChart();
        }

        function renderChart() {
            const ctx = document.getElementById('resultChart').getContext('2d');
            
            // Create Fake Market Average Data (The Average Trap)
            // Market Avg shows steady growth (pulled up by luxury), hiding the mass market crash
            const marketAvgData = gameData.history.playerValue.map((v, i) => {
                const year = gameData.history.years[i];
                if(year === 2019) return v;
                // Fake Index: 100 -> 102 -> 105 -> 115 -> 125 (Looks good!)
                const growthFactors = [1, 1.02, 1.05, 1.15, 1.25, 1.30]; 
                return gameData.asset.initialPrice * growthFactors[i];
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: gameData.history.years,
                    datasets: [{
                        label: '‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (Your Asset)',
                        data: gameData.history.playerValue,
                        borderColor: '#2563eb',
                        backgroundColor: 'rgba(37, 99, 235, 0.1)',
                        borderWidth: 3,
                        fill: true
                    },
                    {
                        label: '‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡∏•‡∏≤‡∏î (Market Average)',
                        data: marketAvgData,
                        borderColor: '#9ca3af',
                        borderDash: [5, 5],
                        borderWidth: 2,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + Math.round(context.raw).toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
