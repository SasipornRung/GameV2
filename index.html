<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bangkok Property Simulator: The 2-Round Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #f8fafc; }
        .fade-in { animation: fadeIn 0.4s ease-in; }
        .slide-up { animation: slideUp 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        /* Modal Fix */
        .modal {
            transition: opacity 0.25s ease;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0,0,0,0.6);
            z-index: 50;
        }
        .hidden { display: none !important; }
    </style>
</head>
<body class="text-slate-800">

    <nav class="bg-slate-900 text-white p-4 sticky top-0 z-40 shadow-md">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <h1 class="font-bold text-yellow-400 text-lg">üèôÔ∏è BKK Property Sim</h1>
            <div class="text-sm space-x-4 font-mono">
                <span>üóìÔ∏è Year: <span id="nav-year" class="text-blue-400 font-bold">2019</span></span>
                <span>üí∞ Cash: <span id="nav-cash" class="text-green-400 font-bold">0</span></span>
            </div>
        </div>
    </nav>

    <main id="app" class="max-w-4xl mx-auto p-6 min-h-screen">
        
        <section id="scene-intro" class="fade-in">
            <div class="bg-white rounded-xl p-8 shadow-lg text-center border-t-4 border-blue-600">
                <h2 class="text-3xl font-extrabold mb-4">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏ô‡πà‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡∏≠‡∏™‡∏±‡∏á‡∏´‡∏≤‡∏Ø</h2>
                <div class="bg-yellow-50 text-yellow-800 p-4 rounded-lg mb-8 text-left border border-yellow-200">
                    <h3 class="font-bold text-lg mb-2">üì¢ ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô (‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡πà‡∏≤‡∏ô):</h3>
                    <ul class="list-disc list-inside space-y-2 text-sm">
                        <li>‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô <b>2 ‡∏£‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à</b> (Round 1: ‡∏õ‡∏µ 2019 ‡πÅ‡∏•‡∏∞ Round 2: ‡∏õ‡∏µ 2022)</li>
                        <li>‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠ Asset ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤</li>
                        <li><b>Goal:</b> ‡∏ï‡∏≠‡∏ô‡∏à‡∏ö‡πÄ‡∏Å‡∏° (‡∏õ‡∏µ 2024) ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ß‡πà‡∏≤ Asset ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å ‡∏Å‡∏±‡∏ö‡∏£‡∏≠‡∏ö‡∏™‡∏≠‡∏á ‡∏≠‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏±‡∏ô</li>
                    </ul>
                </div>
                
                <p class="mb-4 text-slate-500">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="startGame(1)" class="p-6 border-2 border-slate-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition">
                        <div class="text-4xl mb-2">üéí</div>
                        <div class="font-bold">Junior</div>
                        <div class="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 25,000</div>
                        <div class="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö 300,000</div>
                    </button>
                    <button onclick="startGame(2)" class="p-6 border-2 border-slate-200 rounded-xl hover:border-purple-500 hover:bg-purple-50 transition">
                        <div class="text-4xl mb-2">üíº</div>
                        <div class="font-bold">Manager</div>
                        <div class="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 70,000</div>
                        <div class="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö 1,500,000</div>
                    </button>
                    <button onclick="startGame(3)" class="p-6 border-2 border-slate-200 rounded-xl hover:border-amber-500 hover:bg-amber-50 transition">
                        <div class="text-4xl mb-2">üëë</div>
                        <div class="font-bold">Executive</div>
                        <div class="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 200,000</div>
                        <div class="text-xs text-slate-500">‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö 5,000,000</div>
                    </button>
                </div>
            </div>
        </section>

        <section id="scene-action" class="hidden slide-up">
            <div class="text-center mb-8">
                <span class="bg-slate-800 text-white px-3 py-1 rounded-full text-xs uppercase tracking-wide">Round <span id="round-display">1</span> / 2</span>
                <h2 class="text-4xl font-bold mt-2">Year <span id="year-display">2019</span></h2>
                <p id="news-ticker" class="text-blue-600 font-medium mt-2 animate-pulse">‡∏Ç‡πà‡∏≤‡∏ß: ‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏™‡∏≤‡∏¢‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏π‡∏°‡∏™‡∏∏‡∏î‡∏Ç‡∏µ‡∏î...</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div onclick="goToMap()" class="cursor-pointer bg-white p-8 rounded-xl shadow-md border-2 border-transparent hover:border-blue-500 hover:shadow-xl transition group">
                    <div class="text-5xl mb-4 group-hover:scale-110 transition-transform">üè¢</div>
                    <h3 class="text-2xl font-bold text-slate-800">‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î</h3>
                    <p class="text-slate-500 mt-2">‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Å‡πá‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
                </div>

                <div onclick="skipRound()" class="cursor-pointer bg-white p-8 rounded-xl shadow-md border-2 border-transparent hover:border-green-500 hover:shadow-xl transition group">
                    <div class="text-5xl mb-4 group-hover:scale-110 transition-transform">‚è≥</div>
                    <h3 class="text-2xl font-bold text-slate-800">‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠ (Skip)</h3>
                    <p class="text-slate-500 mt-2">‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏≠‡∏ö‡∏ô‡∏µ‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∞‡∏™‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡πÑ‡∏õ‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤</p>
                    <p class="text-xs text-green-600 font-bold mt-4">+ ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏∞‡∏™‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô</p>
                </div>
            </div>
        </section>

        <section id="scene-map" class="hidden slide-up">
            <button onclick="showScene('scene-action')" class="mb-4 text-slate-500 hover:text-slate-800 font-bold">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            <h2 class="text-2xl font-bold mb-6 text-center">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥‡πÄ‡∏• (District)</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <button onclick="selectDistrict('A')" class="bg-white rounded-xl shadow p-6 text-left border hover:border-blue-500 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-red-500 text-white text-xs font-bold px-2 py-1">High Volatility</div>
                    <h3 class="text-xl font-bold">üìç Huai Khwang (Zone A)</h3>
                    <p class="text-sm text-slate-500 mt-1">New CBD Extension, Chinese Hub</p>
                    <div class="mt-4 flex gap-2 text-xs">
                        <span class="bg-slate-100 px-2 py-1 rounded">Avg Price: High</span>
                        <span class="bg-slate-100 px-2 py-1 rounded">Growth: High</span>
                    </div>
                </button>

                <button onclick="selectDistrict('B')" class="bg-white rounded-xl shadow p-6 text-left border hover:border-green-500 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-green-500 text-white text-xs font-bold px-2 py-1">Stable</div>
                    <h3 class="text-xl font-bold">üìç Bang Sue (Zone B)</h3>
                    <p class="text-sm text-slate-500 mt-1">Transportation Hub</p>
                    <div class="mt-4 flex gap-2 text-xs">
                        <span class="bg-slate-100 px-2 py-1 rounded">Avg Price: Medium</span>
                        <span class="bg-slate-100 px-2 py-1 rounded">Growth: Moderate</span>
                    </div>
                </button>
            </div>
        </section>

        <section id="scene-archetype" class="hidden slide-up pb-20">
            <button onclick="showScene('scene-map')" class="mb-4 text-slate-500 hover:text-slate-800 font-bold">‚Üê ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥‡πÄ‡∏•‡πÉ‡∏´‡∏°‡πà</button>
            <h2 class="text-2xl font-bold mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ô‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå (Archetype)</h2>
            <p class="text-sm text-slate-500 mb-6">‡∏Ñ‡∏•‡∏¥‡∏Å "üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</p>

            <div id="archetype-container" class="space-y-4">
                </div>
        </section>

        <section id="scene-result" class="hidden slide-up">
            <h2 class="text-3xl font-bold text-center mb-6">‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô (Year 2024)</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                <div class="bg-white p-6 rounded-xl shadow border-l-8 border-blue-500">
                    <h3 class="font-bold text-slate-400 text-sm uppercase">Round 1 Decision (2019)</h3>
                    <h4 class="text-xl font-bold mt-1" id="r1-name">-</h4>
                    <p class="text-sm mt-2">‡∏ã‡∏∑‡πâ‡∏≠: <span id="r1-buy">-</span></p>
                    <p class="text-sm">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="r1-curr" class="font-bold">-</span></p>
                    <div class="mt-4 pt-4 border-t flex justify-between items-center">
                        <span class="text-xs">Profit (Price+Rent)</span>
                        <span id="r1-profit" class="text-xl font-bold">-</span>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow border-l-8 border-purple-500">
                    <h3 class="font-bold text-slate-400 text-sm uppercase">Round 2 Decision (2022)</h3>
                    <h4 class="text-xl font-bold mt-1" id="r2-name">-</h4>
                    <p class="text-sm mt-2">‡∏ã‡∏∑‡πâ‡∏≠: <span id="r2-buy">-</span></p>
                    <p class="text-sm">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="r2-curr" class="font-bold">-</span></p>
                    <div class="mt-4 pt-4 border-t flex justify-between items-center">
                        <span class="text-xs">Profit (Price+Rent)</span>
                        <span id="r2-profit" class="text-xl font-bold">-</span>
                    </div>
                </div>
            </div>

            <div class="bg-slate-800 text-white p-6 rounded-xl shadow-lg">
                <h3 class="text-xl font-bold text-yellow-400 mb-2">üí° Analysis: ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ</h3>
                <div class="text-sm space-y-3 font-light">
                    <p>1. <b>Timing Matters:</b> ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏õ‡∏µ 2019 (‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏Ñ‡∏ß‡∏¥‡∏î) ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏µ‡πÄ‡∏™‡∏°‡∏≠‡πÑ‡∏õ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ <span class="text-red-400 font-bold">Type 1 (Mass Market)</span> ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏¥‡πà‡∏á‡∏•‡∏á‡πÄ‡∏´‡∏ß‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏¥‡∏Å‡∏§‡∏ï</p>
                    <p>2. <b>Archetype is King:</b> ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤ <span class="text-green-400 font-bold">Type 3 (Luxury)</span> ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏∏‡πà‡∏á‡∏™‡∏ß‡∏ô‡∏ó‡∏≤‡∏á‡∏ï‡∏•‡∏≤‡∏î (K-Shaped Recovery) ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏≤‡∏¢‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏ô‡∏°‡∏µ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏π‡∏á</p>
                    <p>3. <b>Saving Strategy:</b> ‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠ "‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô" ‡πÑ‡∏õ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ Archetype ‡πÅ‡∏û‡∏á‡πÜ ‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏™‡∏≠‡∏á ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®</p>
                </div>
                <button onclick="location.reload()" class="mt-6 w-full py-3 bg-blue-600 hover:bg-blue-700 rounded font-bold">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà</button>
            </div>
        </section>

    </main>

    <div id="modal-analysis" class="modal hidden">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden animate-slide-up">
            <div class="bg-slate-900 p-4 text-white flex justify-between items-center">
                <h3 class="font-bold">üìä Asset Analysis</h3>
                <button onclick="closeModal()" class="text-slate-400 hover:text-white font-bold text-xl">&times;</button>
            </div>
            
            <div class="p-6">
                <h2 id="m-title" class="text-2xl font-bold text-slate-800 mb-1">Type Name</h2>
                <p id="m-price" class="text-lg font-mono text-blue-600 font-bold mb-4">Price: 0 THB</p>

                <div class="space-y-4 mb-6">
                    <div class="bg-slate-50 p-3 rounded border">
                        <h4 class="font-bold text-xs text-slate-400 uppercase">SWOT: Strengths</h4>
                        <p id="m-strength" class="text-sm text-green-700">...</p>
                    </div>
                    <div class="bg-slate-50 p-3 rounded border">
                        <h4 class="font-bold text-xs text-slate-400 uppercase">SWOT: Weaknesses & Threats</h4>
                        <p id="m-weakness" class="text-sm text-red-700">...</p>
                    </div>
                    <div class="bg-slate-50 p-3 rounded border">
                        <h4 class="font-bold text-xs text-slate-400 uppercase">Target Audience</h4>
                        <p id="m-target" class="text-sm text-slate-700">...</p>
                    </div>
                </div>

                <div class="flex gap-3">
                    <button onclick="closeModal()" class="flex-1 py-3 border border-slate-300 rounded hover:bg-slate-50">‡∏õ‡∏¥‡∏î</button>
                    <button id="btn-confirm-buy" onclick="confirmBuy()" class="flex-1 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 font-bold shadow">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- GAME STATE ---
        let state = {
            cash: 0,
            salary: 0,
            year: 2019,
            round: 1,
            portfolio: [],
            tempItem: null
        };

        // --- DATA [Sources: 1-72] ---
        const archetypes = {
            'A': [ // Huai Khwang
                {
                    id: 'A1',
                    name: 'Type 1: Entry Level',
                    price: 2200000,
                    desc: '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏•‡πá‡∏Å‡πÉ‡∏ô‡∏ã‡∏≠‡∏¢‡∏•‡∏∂‡∏Å (Deep Soi)',
                    strength: '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÄ‡∏ä‡πà‡∏≤ Mass Market ‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß',
                    weakness: '‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å (Red Ocean) ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏Å‡∏á‡πà‡∏≤‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡∏®‡∏Å.‡πÅ‡∏¢‡πà',
                    target: 'First Jobber / ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤',
                    growth: [1.0, 0.85, 0.82, 0.80, 0.81, 0.78] // 2019-2024 Index
                },
                {
                    id: 'A2',
                    name: 'Type 2: Real Demand',
                    price: 4500000,
                    desc: 'Standard Condo ‡πÉ‡∏Å‡∏•‡πâ MRT',
                    strength: '‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏î‡∏µ ‡πÄ‡∏õ‡πá‡∏ô Safe Haven ‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á‡∏™‡∏π‡∏á',
                    weakness: '‡∏Å‡∏≥‡πÑ‡∏£‡∏Å‡∏•‡∏≤‡∏á‡πÜ ‡πÑ‡∏°‡πà‡∏´‡∏ß‡∏∑‡∏≠‡∏´‡∏ß‡∏≤ ‡∏ä‡∏ô‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏ü‡πâ‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢',
                    target: 'White Collar / Senior Officer',
                    growth: [1.0, 0.95, 0.96, 0.98, 1.02, 1.05]
                },
                {
                    id: 'A3',
                    name: 'Type 3: Prime Luxury',
                    price: 12000000,
                    desc: 'High-End ‡∏ï‡∏¥‡∏î‡∏ñ‡∏ô‡∏ô‡πÉ‡∏´‡∏ç‡πà/MRT',
                    strength: 'Scarcity Value (‡∏´‡∏≤‡∏¢‡∏≤‡∏Å) ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏∏‡πà‡∏á‡πÅ‡∏£‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏µ‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤',
                    weakness: '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏¢‡πá‡∏ô ‡∏ñ‡∏∑‡∏≠‡∏¢‡∏≤‡∏ß',
                    target: 'Expat / Wealthy Investors',
                    growth: [1.0, 1.05, 1.30, 1.45, 1.60, 1.75]
                }
            ],
            'B': [ // Bang Sue
                {
                    id: 'B1',
                    name: 'Type 1: Budget Outer',
                    price: 1500000,
                    desc: '‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏ä‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    strength: '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡∏î‡πÜ',
                    weakness: 'Over supply ‡∏´‡∏ô‡∏±‡∏Å‡∏°‡∏≤‡∏Å ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏ó‡∏ö‡πÑ‡∏°‡πà‡∏Ç‡∏¢‡∏±‡∏ö',
                    target: 'Factory Workers',
                    growth: [1.0, 0.98, 0.97, 0.96, 0.97, 0.98]
                },
                {
                    id: 'B2',
                    name: 'Type 2: Hub Station',
                    price: 3500000,
                    desc: '‡πÉ‡∏Å‡∏•‡πâ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏Å‡∏•‡∏≤‡∏á‡∏Ø',
                    strength: 'Infrastructure ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏î‡∏µ ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß',
                    weakness: 'Supply ‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÅ‡∏ï‡πà Demand ‡πÇ‡∏ï‡∏ä‡πâ‡∏≤‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    target: 'Commuters',
                    growth: [1.0, 1.02, 1.03, 1.05, 1.07, 1.10]
                }
            ]
        };

        // --- CORE FUNCTIONS ---
        function showScene(id) {
            document.querySelectorAll('section').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function updateUI() {
            document.getElementById('nav-cash').innerText = state.cash.toLocaleString();
            document.getElementById('nav-year').innerText = state.year;
            document.getElementById('round-display').innerText = state.round;
            document.getElementById('year-display').innerText = state.year;
            
            // News Ticker logic
            const news = state.year === 2019 
                ? "2019: ‡∏¢‡∏∏‡∏Ñ‡∏£‡∏∏‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏≤‡∏¢‡∏∏... ‡∏ï‡∏•‡∏≤‡∏î‡∏Ñ‡∏∂‡∏Å‡∏Ñ‡∏±‡∏Å‡∏™‡∏∏‡∏î‡∏Ç‡∏µ‡∏î" 
                : "2022: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®... ‡∏ï‡∏•‡∏≤‡∏î‡∏ü‡∏∑‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ö‡∏ö K-Shaped (‡∏£‡∏ß‡∏¢‡∏Å‡∏£‡∏∞‡∏à‡∏∏‡∏Å ‡∏à‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢)";
            document.getElementById('news-ticker').innerText = news;
        }

        function startGame(level) {
            if(level === 1) { state.salary = 25000; state.cash = 300000; }
            if(level === 2) { state.salary = 70000; state.cash = 1500000; }
            if(level === 3) { state.salary = 200000; state.cash = 5000000; }
            
            state.year = 2019;
            state.round = 1;
            state.portfolio = [];
            
            updateUI();
            showScene('scene-action');
        }

        function goToMap() {
            showScene('scene-map');
        }

        function skipRound() {
            // Logic: Skip 3 years of savings (50% saving rate)
            const savings = (state.salary * 12 * 3) * 0.5;
            state.cash += savings;
            
            // Record skipping
            state.portfolio.push({
                type: 'skipped',
                name: 'Saving (Wait)',
                buyPrice: 0,
                yearBought: state.year
            });

            alert(`‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏£‡∏≠... ‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ 3 ‡∏õ‡∏µ ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ ${savings.toLocaleString()} ‡∏ö‡∏≤‡∏ó`);
            advanceRound();
        }

        function selectDistrict(zone) {
            const list = archetypes[zone];
            const container = document.getElementById('archetype-container');
            container.innerHTML = '';

            list.forEach(item => {
                // Down Payment 15% check
                const downPayment = item.price * 0.15;
                const canAfford = state.cash >= downPayment;
                const btnStyle = canAfford ? 'bg-blue-600 text-white hover:bg-blue-700' : 'bg-gray-300 text-gray-500 cursor-not-allowed';
                const statusText = canAfford ? '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ã‡∏∑‡πâ‡∏≠ (‡∏î‡∏≤‡∏ß‡∏ô‡πå 15%)' : '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≤‡∏ß‡∏ô‡πå';

                container.innerHTML += `
                    <div class="bg-white border rounded-xl p-4 shadow-sm flex flex-col md:flex-row justify-between items-center gap-4">
                        <div class="flex-1">
                            <h3 class="font-bold text-lg">${item.name}</h3>
                            <p class="text-sm text-slate-500">${item.desc}</p>
                            <p class="font-mono text-blue-600 font-bold mt-1">‡∏£‡∏≤‡∏Ñ‡∏≤: ${(item.price).toLocaleString()} THB</p>
                        </div>
                        <div class="text-right">
                             <p class="text-xs mb-2 ${canAfford ? 'text-green-600' : 'text-red-500'} font-bold">${statusText}</p>
                             <button onclick="openModal('${zone}', '${item.id}')" class="px-6 py-2 rounded font-bold shadow transition ${btnStyle}" ${!canAfford ? 'disabled' : ''}>
                                üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå & ‡∏ã‡∏∑‡πâ‡∏≠
                             </button>
                        </div>
                    </div>
                `;
            });

            showScene('scene-archetype');
        }

        function openModal(zone, id) {
            const item = archetypes[zone].find(x => x.id === id);
            state.tempItem = item;

            // Update Modal Content
            document.getElementById('m-title').innerText = item.name;
            document.getElementById('m-price').innerText = item.price.toLocaleString() + ' THB';
            document.getElementById('m-strength').innerText = item.strength;
            document.getElementById('m-weakness').innerText = item.weakness;
            document.getElementById('m-target').innerText = item.target;

            // Show Modal
            document.getElementById('modal-analysis').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal-analysis').classList.add('hidden');
        }

        function confirmBuy() {
            const item = state.tempItem;
            const downPayment = item.price * 0.15;

            // Deduct Cash
            state.cash -= downPayment;

            // Add to Portfolio
            state.portfolio.push({
                ...item,
                yearBought: state.year,
                buyPrice: item.price
            });

            closeModal();
            advanceRound();
        }

        function advanceRound() {
            if(state.round === 1) {
                state.round = 2;
                state.year = 2022;

                // Income form Assets (if bought in round 1)
                const r1Asset = state.portfolio[0];
                if(r1Asset && r1Asset.type !== 'skipped') {
                    // Simple Rent: 4% yield for 3 years * efficiency
                    // If Type 1 (Entry) -> Efficiency low due to Covid (0.6)
                    const efficiency = r1Asset.id.includes('1') ? 0.6 : 0.9;
                    const rent = (r1Asset.buyPrice * 0.04 * 3 * efficiency);
                    state.cash += rent;
                    alert(`‡∏à‡∏ö Round 1: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏õ‡∏µ 2022\n‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏™‡∏∞‡∏™‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÇ‡∏Ñ‡∏ß‡∏¥‡∏î: ${Math.round(rent).toLocaleString()} ‡∏ö‡∏≤‡∏ó`);
                } else {
                    alert(`‡∏à‡∏ö Round 1: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏õ‡∏µ 2022`);
                }

                updateUI();
                showScene('scene-action');
            } else {
                endGame();
            }
        }

        function endGame() {
            // Process Results
            processResultSlot('r1', state.portfolio[0]);
            processResultSlot('r2', state.portfolio[1]);
            showScene('scene-result');
        }

        function processResultSlot(slotId, asset) {
            if(!asset || asset.type === 'skipped') {
                document.getElementById(`${slotId}-name`).innerText = "‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏á‡∏ó‡∏∏‡∏ô (Skipped)";
                document.getElementById(`${slotId}-buy`).innerText = "-";
                document.getElementById(`${slotId}-curr`).innerText = "-";
                document.getElementById(`${slotId}-profit`).innerText = "‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏ù‡∏≤‡∏Å";
                document.getElementById(`${slotId}-profit`).classList.add('text-gray-500');
                return;
            }

            // Calculate Price in 2024
            // Index Mapping: 2019=0, 2020=1, 2021=2, 2022=3, 2023=4, 2024=5
            const startIdx = asset.yearBought === 2019 ? 0 : 3;
            const endIdx = 5;
            
            const growthRate = asset.growth[endIdx] / asset.growth[startIdx];
            const currentPrice = asset.buyPrice * growthRate;
            
            // Rent (Remaining years)
            const yearsHeld = 2024 - asset.yearBought;
            const rent = (asset.buyPrice * 0.045 * yearsHeld); // Approx rent

            const profit = (currentPrice - asset.buyPrice) + rent;

            document.getElementById(`${slotId}-name`).innerText = asset.name;
            document.getElementById(`${slotId}-buy`).innerText = (asset.buyPrice/1000000).toFixed(2) + " MB";
            document.getElementById(`${slotId}-curr`).innerText = (currentPrice/1000000).toFixed(2) + " MB";
            
            const sign = profit > 0 ? "+" : "";
            const profitElem = document.getElementById(`${slotId}-profit`);
            profitElem.innerText = `${sign}${(profit/1000000).toFixed(2)} MB`;
            
            if(profit > 0) profitElem.classList.add('text-green-600');
            else profitElem.classList.add('text-red-600');
        }

    </script>
</body>
</html>
